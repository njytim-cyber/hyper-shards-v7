[{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\playwright.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\scripts\\auto-doc.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\scripts\\generate-media.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\scripts\\init-repo.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\App.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\App.tsx:43:5\n  41 |   useEffect(() => {\n  42 |     persistence.load();\n> 43 |     setHighScore(persistence.profile.highScore);\n     |     ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  44 |\n  45 |     // Show intro on first play\n  46 |     if (!persistence.profile.hasSeenIntro) {","line":43,"column":5,"nodeType":null,"endLine":43,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_pilotId' is defined but never used.","line":105,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":105,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_shards' is defined but never used.","line":109,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":109,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":114,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3848,3851],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3848,3851],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3894,3897],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3894,3897],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3942,3945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3942,3945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_score' is defined but never used.","line":119,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":119,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_combo' is defined but never used.","line":130,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":130,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_val' is defined but never used.","line":130,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":130,"endColumn":35}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { HUD } from './components/ui/HUD';\r\nimport { StartScreen } from './components/screens/StartScreen';\r\nimport { GameOverScreen } from './components/screens/GameOverScreen';\r\nimport { PauseScreen } from './components/screens/PauseScreen';\r\nimport { ShopScreen } from './components/screens/ShopScreen';\r\nimport { IntroScreen } from './components/screens/IntroScreen';\r\nimport { AchievementsScreen } from './components/screens/AchievementsScreen';\r\nimport { DailyRewardsPopup } from './components/screens/DailyRewardsPopup';\r\nimport { PilotSelectScreen } from './components/screens/PilotSelectScreen';\r\nimport { gameEngine } from './game/core/GameEngine';\r\nimport { persistence } from './game/systems/Persistence';\r\nimport { audioSystem } from './game/systems/AudioSystem';\r\nimport { canClaimDailyReward } from './game/config/DailyRewardsConfig';\r\nimport { CanvasView } from './views/CanvasView';\r\nimport { ParticleContainer } from './components/containers/ParticleContainer';\r\nimport { PlayerContainer } from './components/containers/PlayerContainer';\r\nimport { Icons } from './components/ui/Icons';\r\nimport { DialogueDisplay } from './components/ui/DialogueDisplay';\r\n\r\nimport './styles/index.css';\r\n\r\ntype GameStateType = 'INTRO' | 'START' | 'PLAYING' | 'PAUSED' | 'GAMEOVER' | 'VICTORY' | 'SHOP' | 'ACHIEVEMENTS' | 'PILOTS';\r\n\r\nfunction App() {\r\n  const [gameState, setGameState] = useState<GameStateType>('START');\r\n  const [hudState, setHudState] = useState({\r\n    lives: 3,\r\n    shields: 0,\r\n    wave: 1,\r\n    weapon: 'BLASTER',\r\n    showWave: false\r\n  });\r\n  const [levelText, setLevelText] = useState({ show: false, wave: 1, sub: '', hint: '', isBoss: false });\r\n  const [highScore, setHighScore] = useState(0);\r\n  const [isNewHighScore, setIsNewHighScore] = useState(false);\r\n  const [showDailyRewards, setShowDailyRewards] = useState(false);\r\n  const [previousState, setPreviousState] = useState<GameStateType>('START');\r\n  const [preShopTrack, setPreShopTrack] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    persistence.load();\r\n    setHighScore(persistence.profile.highScore);\r\n\r\n    // Show intro on first play\r\n    if (!persistence.profile.hasSeenIntro) {\r\n      setGameState('INTRO');\r\n    }\r\n\r\n    // Check for daily rewards\r\n    if (canClaimDailyReward(persistence.profile.dailyRewards)) {\r\n      setTimeout(() => setShowDailyRewards(true), 500);\r\n    }\r\n  }, []);\r\n\r\n  const handleIntroComplete = () => {\r\n    setGameState('START');\r\n    audioSystem.playMusic('load');\r\n  };\r\n\r\n  const handleStart = () => {\r\n    setGameState('PLAYING');\r\n    gameEngine.startGame();\r\n    audioSystem.playMusic('wave');\r\n  };\r\n\r\n  const handlePause = () => {\r\n    gameEngine.togglePause();\r\n  };\r\n\r\n  const handleOpenShop = () => {\r\n    setPreviousState(gameState);\r\n    setPreShopTrack(audioSystem.lastTrackName);\r\n    setGameState('SHOP');\r\n  };\r\n\r\n  const handleCloseShop = () => {\r\n    if (previousState === 'PAUSED') {\r\n      setGameState('PAUSED');\r\n      if (preShopTrack) audioSystem.playMusic(preShopTrack);\r\n    } else {\r\n      setGameState('START');\r\n      audioSystem.playMusic('load');\r\n    }\r\n  };\r\n\r\n  const handleOpenAchievements = () => {\r\n    setPreviousState(gameState);\r\n    setGameState('ACHIEVEMENTS');\r\n  };\r\n\r\n  const handleCloseAchievements = () => {\r\n    setGameState(previousState);\r\n  };\r\n\r\n  const handleOpenPilots = () => {\r\n    setPreviousState(gameState);\r\n    setGameState('PILOTS');\r\n  };\r\n\r\n  const handleClosePilots = () => {\r\n    setGameState(previousState);\r\n  };\r\n\r\n  const handlePilotSelect = (_pilotId: string) => {\r\n    setGameState(previousState);\r\n  };\r\n\r\n  const handleDailyRewardClaim = (_shards: number) => {\r\n    // Could show a nice animation here\r\n  };\r\n\r\n  const handleCanvasReady = (canvas: HTMLCanvasElement) => {\r\n    (window as any).gameEngine = gameEngine;\r\n    (window as any).persistence = persistence;\r\n    (window as any).audioSystem = audioSystem;\r\n\r\n    gameEngine.init(canvas, {\r\n      onScoreUpdate: (_score) => { /* No-op */ },\r\n      onWaveUpdate: (wave, sub, hint, boss) => {\r\n        const isTutorial = sub === \"TUTORIAL\";\r\n        setHudState(prev => ({ ...prev, wave, showWave: !isTutorial }));\r\n        if (!isTutorial) {\r\n          setLevelText({ show: true, wave, sub, hint, isBoss: boss });\r\n          setTimeout(() => setLevelText(prev => ({ ...prev, show: false })), 3000);\r\n        }\r\n      },\r\n      onLivesUpdate: (lives, shields) => setHudState(prev => ({ ...prev, lives, shields })),\r\n      onWeaponUpdate: (weapon) => setHudState(prev => ({ ...prev, weapon })),\r\n      onComboUpdate: (_combo, _val) => { /* No-op */ },\r\n      onGameOver: (_score, hs, newHigh) => {\r\n        setGameState('GAMEOVER');\r\n        setHighScore(hs);\r\n        setIsNewHighScore(newHigh);\r\n        persistence.trackStat('totalGamesPlayed', 1);\r\n      },\r\n      onVictory: (score, hs) => {\r\n        setGameState('VICTORY');\r\n        setHighScore(hs);\r\n        setIsNewHighScore(score > hs);\r\n        persistence.trackStat('totalGamesPlayed', 1);\r\n      },\r\n      onGameStart: () => setGameState('PLAYING'),\r\n      onPause: (isPaused) => setGameState(isPaused ? 'PAUSED' : 'PLAYING')\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"app-container\" style={{ width: '100vw', height: '100vh', overflow: 'hidden', position: 'relative', background: '#050505' }}>\r\n      <Icons />\r\n      <PlayerContainer />\r\n      <ParticleContainer />\r\n      <CanvasView onCanvasReady={handleCanvasReady} />\r\n\r\n      {gameState === 'INTRO' && (\r\n        <IntroScreen onComplete={handleIntroComplete} onSkip={handleIntroComplete} />\r\n      )}\r\n\r\n      {gameState === 'PLAYING' && (\r\n        <HUD\r\n          lives={hudState.lives}\r\n          shields={hudState.shields}\r\n          wave={hudState.wave}\r\n          weapon={hudState.weapon}\r\n          shards={persistence.profile.shards}\r\n          onPause={handlePause}\r\n          showWave={hudState.showWave}\r\n        />\r\n      )}\r\n\r\n      {gameState === 'START' && (\r\n        <StartScreen\r\n          onStart={handleStart}\r\n          onOpenShop={handleOpenShop}\r\n          onOpenAchievements={handleOpenAchievements}\r\n          onOpenPilots={handleOpenPilots}\r\n          highScore={highScore}\r\n        />\r\n      )}\r\n\r\n      {(gameState === 'GAMEOVER' || gameState === 'VICTORY') && (\r\n        <GameOverScreen\r\n          score={gameEngine.score}\r\n          highScore={highScore}\r\n          isNewHighScore={isNewHighScore}\r\n          isVictory={gameState === 'VICTORY'}\r\n          onRestart={handleStart}\r\n          onOpenShop={handleOpenShop}\r\n        />\r\n      )}\r\n\r\n      {gameState === 'PAUSED' && (\r\n        <PauseScreen onResume={handlePause} onOpenShop={handleOpenShop} />\r\n      )}\r\n\r\n      {gameState === 'SHOP' && <ShopScreen onClose={handleCloseShop} />}\r\n\r\n      {gameState === 'ACHIEVEMENTS' && (\r\n        <AchievementsScreen onClose={handleCloseAchievements} />\r\n      )}\r\n\r\n      {gameState === 'PILOTS' && (\r\n        <PilotSelectScreen onClose={handleClosePilots} onSelect={handlePilotSelect} />\r\n      )}\r\n\r\n      {showDailyRewards && (\r\n        <DailyRewardsPopup\r\n          onClose={() => setShowDailyRewards(false)}\r\n          onClaim={handleDailyRewardClaim}\r\n        />\r\n      )}\r\n\r\n      {/* Pilot Dialogue Display */}\r\n      <DialogueDisplay />\r\n\r\n      {/* Tutorial Layer */}\r\n      <div id=\"tutorial-layer\"></div>\r\n\r\n      {/* Level Overlay */}\r\n      <div id=\"level-screen\" className={`${levelText.show ? 'show-level' : ''} ${levelText.isBoss ? 'boss-alert-bg' : ''}`}>\r\n        <div id=\"level-title\" className=\"cyan-glow\" style={{ color: levelText.isBoss ? '#f00' : '#0ff' }}>\r\n          {levelText.isBoss ? 'WARNING' : `WAVE ${levelText.wave}`}\r\n        </div>\r\n        <div id=\"level-sub\" style={{ fontSize: '20px', color: '#fff', marginTop: '10px', textTransform: 'uppercase', letterSpacing: '2px' }}>\r\n          {levelText.sub}\r\n        </div>\r\n        <div id=\"level-hint\" style={{ fontSize: '14px', color: '#aaa', marginTop: '20px', fontStyle: 'italic' }}>\r\n          {levelText.hint}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\bridges\\WebTransportBridge.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[596,599],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[596,599],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[672,675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[672,675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[720,723],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[720,723],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\GameCanvas.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'props.onComboUpdate', 'props.onGameOver', 'props.onGameStart', 'props.onLivesUpdate', 'props.onPause', 'props.onScoreUpdate', 'props.onWaveUpdate', and 'props.onWeaponUpdate'. Either include them or remove the dependency array.","line":31,"column":8,"nodeType":"ArrayExpression","endLine":31,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [props.onComboUpdate, props.onGameOver, props.onGameStart, props.onLivesUpdate, props.onPause, props.onScoreUpdate, props.onWaveUpdate, props.onWeaponUpdate]","fix":{"range":[1251,1253],"text":"[props.onComboUpdate, props.onGameOver, props.onGameStart, props.onLivesUpdate, props.onPause, props.onScoreUpdate, props.onWaveUpdate, props.onWeaponUpdate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\r\nimport { gameEngine } from '../game/core/GameEngine';\r\n\r\ninterface GameCanvasProps {\r\n    onScoreUpdate: (score: number) => void;\r\n    onWaveUpdate: (wave: number, subText: string, hintText: string, isBoss: boolean) => void;\r\n    onLivesUpdate: (lives: number, shields: number) => void;\r\n    onWeaponUpdate: (weapon: string) => void;\r\n    onComboUpdate: (combo: number, val: number) => void;\r\n    onGameOver: (score: number, highScore: number) => void;\r\n    onGameStart: () => void;\r\n    onPause: (isPaused: boolean) => void;\r\n}\r\n\r\nexport const GameCanvas: React.FC<GameCanvasProps> = (props) => {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (canvasRef.current) {\r\n            gameEngine.init(canvasRef.current, {\r\n                onScoreUpdate: props.onScoreUpdate,\r\n                onWaveUpdate: props.onWaveUpdate,\r\n                onLivesUpdate: props.onLivesUpdate,\r\n                onWeaponUpdate: props.onWeaponUpdate,\r\n                onComboUpdate: props.onComboUpdate,\r\n                onGameOver: props.onGameOver,\r\n                onGameStart: props.onGameStart,\r\n                onPause: props.onPause\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    return <canvas ref={canvasRef} id=\"gameCanvas\" style={{ display: 'block' }} />;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\containers\\ParticleContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\containers\\PlayerContainer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_data' is defined but never used.","line":12,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\r\nimport { WebTransportBridge } from '../../bridges/WebTransportBridge';\r\nimport { gameEngine } from '../../game/core/GameEngine';\r\n\r\nexport const PlayerContainer: React.FC = () => {\r\n    const bridgeRef = useRef<WebTransportBridge | null>(null);\r\n\r\n    useEffect(() => {\r\n        // Initialize Bridge\r\n        const bridge = new WebTransportBridge({\r\n            url: 'https://localhost:4433/hyper-shards', // Example URL\r\n            onDatagramReceived: (_data) => {\r\n                // Handle incoming position updates from other players\r\n                // For now, we just log it or decode it\r\n                // const view = new DataView(data.buffer);\r\n                // const id = view.getUint32(0, true);\r\n                // const x = view.getFloat32(4, true);\r\n                // const y = view.getFloat32(8, true);\r\n                // console.log(`Received update for ${id}: ${x}, ${y}`);\r\n            }\r\n        });\r\n\r\n        bridge.connect();\r\n        bridgeRef.current = bridge;\r\n\r\n        // Hook into Game Loop for high-frequency updates\r\n        const updateInterval = setInterval(() => {\r\n            if (gameEngine.ship && !gameEngine.ship.dead) {\r\n                // Create packet: ID (4) + X (4) + Y (4) + Rot (4) = 16 bytes\r\n                const buffer = new ArrayBuffer(16);\r\n                const view = new DataView(buffer);\r\n\r\n                // Mock ID for local player\r\n                view.setUint32(0, 1, true);\r\n                view.setFloat32(4, gameEngine.ship.x, true);\r\n                view.setFloat32(8, gameEngine.ship.y, true);\r\n                view.setFloat32(12, gameEngine.ship.angle, true);\r\n\r\n                bridge.sendDatagram(new Uint8Array(buffer));\r\n            }\r\n        }, 1000 / 60); // 60 Hz updates\r\n\r\n        return () => {\r\n            clearInterval(updateInterval);\r\n            bridge.close();\r\n        };\r\n    }, []);\r\n\r\n    return null; // Logic-only container, no UI\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\AchievementsScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\DailyRewardsPopup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\GameOverScreen.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\GameOverScreen.tsx:44:36\n  42 |     const randomMessage = React.useMemo(() => {\n  43 |         const messages = isVictory ? victoryMessages : funnyMessages;\n> 44 |         return messages[Math.floor(Math.random() * messages.length)];\n     |                                    ^^^^^^^^^^^^^ Cannot call impure function\n  45 |     }, [isVictory]);\n  46 |\n  47 |     return (","line":44,"column":36,"nodeType":null,"endLine":44,"endColumn":49},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useMemo has missing dependencies: 'funnyMessages' and 'victoryMessages'. Either include them or remove the dependency array.","line":45,"column":8,"nodeType":"ArrayExpression","endLine":45,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [funnyMessages, isVictory, victoryMessages]","fix":{"range":[1241,1252],"text":"[funnyMessages, isVictory, victoryMessages]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { CURRENCY } from '../../game/config/CurrencyConfig';\r\n\r\ninterface GameOverScreenProps {\r\n    score: number;\r\n    highScore: number;\r\n    isNewHighScore?: boolean;\r\n    isVictory?: boolean;\r\n    onRestart: () => void;\r\n    onOpenShop: () => void;\r\n}\r\n\r\nexport const GameOverScreen: React.FC<GameOverScreenProps> = ({\r\n    score,\r\n    highScore,\r\n    isNewHighScore,\r\n    isVictory,\r\n    onRestart,\r\n    onOpenShop\r\n}) => {\r\n    const funnyMessages = [\r\n        \"GAME OVER MAN, GAME OVER\",\r\n        \"MISSION FAILED SUCCESSFULLY\",\r\n        \"ASTEROID HUGGED YOU\",\r\n        \"SPACESHIP NEEDS A NAP\",\r\n        \"OUT OF FUEL (AND LUCK)\",\r\n        \"BETTER LUCK NEXT ORBIT\",\r\n        \"YOU BECAME STARDUST\",\r\n        \"NICE TRY, CAPTAIN!\",\r\n        \"R.I.P. (REST IN PLASMA)\",\r\n        \"DID YOU FORGET TO DASH?\"\r\n    ];\r\n\r\n    const victoryMessages = [\r\n        \"MOTHERSHIP DESTROYED!\",\r\n        \"HUMANITY IS SAVED!\",\r\n        \"YOU ARE A LEGEND!\",\r\n        \"THE COLLECTIVE FALLS!\",\r\n        \"GALAXY DEFENDER!\"\r\n    ];\r\n\r\n    const randomMessage = React.useMemo(() => {\r\n        const messages = isVictory ? victoryMessages : funnyMessages;\r\n        return messages[Math.floor(Math.random() * messages.length)];\r\n    }, [isVictory]);\r\n\r\n    return (\r\n        <div id=\"game-over-screen\" style={{\r\n            background: isVictory\r\n                ? 'linear-gradient(135deg, rgba(0,50,0,0.95) 0%, rgba(0,0,0,0.98) 100%)'\r\n                : undefined\r\n        }}>\r\n            {isVictory && (\r\n                <div style={{\r\n                    position: 'absolute',\r\n                    top: 0,\r\n                    left: 0,\r\n                    right: 0,\r\n                    bottom: 0,\r\n                    background: 'radial-gradient(circle at 50% 30%, rgba(255,215,0,0.1) 0%, transparent 50%)',\r\n                    pointerEvents: 'none'\r\n                }} />\r\n            )}\r\n\r\n            <h1\r\n                className=\"neon-header\"\r\n                style={{\r\n                    color: isVictory ? '#ffd700' : '#0ff',\r\n                    textShadow: isVictory\r\n                        ? '0 0 30px #ffd700, 0 0 60px #ff0'\r\n                        : '0 0 20px #0ff'\r\n                }}\r\n            >\r\n                {randomMessage}\r\n            </h1>\r\n\r\n            {isVictory && (\r\n                <div style={{\r\n                    fontSize: '80px',\r\n                    margin: '20px 0',\r\n                    animation: 'victoryPulse 1s infinite'\r\n                }}>\r\n                    ≡ƒÅå\r\n                </div>\r\n            )}\r\n\r\n            <p id=\"final-score\" style={{\r\n                fontSize: '20px',\r\n                color: '#fff',\r\n                lineHeight: 1.6,\r\n                marginBottom: '30px'\r\n            }}>\r\n                Score: {score}<br />High Score: {highScore}\r\n            </p>\r\n\r\n            {isVictory && (\r\n                <div style={{\r\n                    color: '#0f0',\r\n                    fontSize: '16px',\r\n                    marginBottom: '20px',\r\n                    padding: '10px 20px',\r\n                    background: 'rgba(0,255,0,0.1)',\r\n                    borderRadius: '8px',\r\n                    border: '1px solid rgba(0,255,0,0.3)'\r\n                }}>\r\n                    ≡ƒÄë +500 {CURRENCY.symbol} Bonus Awarded!\r\n                </div>\r\n            )}\r\n\r\n            {isNewHighScore && (\r\n                <div className=\"blink\" style={{\r\n                    color: '#ff0',\r\n                    fontSize: '24px',\r\n                    fontWeight: 'bold',\r\n                    marginBottom: '20px',\r\n                    textShadow: '0 0 10px #ff0'\r\n                }}>\r\n                    NEW HIGH SCORE!\r\n                </div>\r\n            )}\r\n\r\n            <div\r\n                id=\"restart-btn\"\r\n                className=\"tap-text blink\"\r\n                style={{ color: isVictory ? '#ffd700' : '#0ff', fontSize: '20px', cursor: 'pointer' }}\r\n                onClick={onRestart}\r\n            >\r\n                {isVictory ? 'PLAY AGAIN' : 'TAP TO RESTART'}\r\n            </div>\r\n\r\n            <div\r\n                id=\"home-btn\"\r\n                className=\"spend-btn\"\r\n                style={{ marginTop: '20px' }}\r\n                onClick={onOpenShop}\r\n            >\r\n                SPEND MY SHARDS\r\n            </div>\r\n\r\n            <style>{`\r\n                @keyframes victoryPulse {\r\n                    0%, 100% { transform: scale(1); }\r\n                    50% { transform: scale(1.1); }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\IntroScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\PauseScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\PilotSelectScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\ShopScreen.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":145,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5471,5474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5471,5474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":185,"column":65,"nodeType":null,"messageId":"unusedVar","endLine":185,"endColumn":66}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { persistence } from '../../game/systems/Persistence';\r\nimport { audioSystem } from '../../game/systems/AudioSystem';\r\nimport { UPGRADE_CONFIG, SKIN_CONFIG } from '../../game/config/ShopConfig';\r\n\r\ninterface ShopScreenProps {\r\n    onClose: () => void;\r\n}\r\n\r\nimport { drawIcon, drawShipPreview } from '../../game/utils/IconDrawer';\r\n\r\ninterface ShopItemIconProps {\r\n    type: string;\r\n    isSkin?: boolean;\r\n    color?: string;\r\n    design?: string;\r\n    isSecret?: boolean;\r\n}\r\n\r\nconst ShopItemIcon: React.FC<ShopItemIconProps> = ({ type, isSkin, color, design, isSecret }) => {\r\n    const canvasRef = React.useRef<HTMLCanvasElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (canvasRef.current) {\r\n            if (isSkin) {\r\n                drawShipPreview(canvasRef.current, color!, design!, isSecret);\r\n            } else {\r\n                drawIcon(canvasRef.current, type);\r\n            }\r\n        }\r\n    }, [type, isSkin, color, design, isSecret]);\r\n\r\n    return <canvas ref={canvasRef} width={40} height={40} className=\"shop-item-preview\" style={isSkin ? { borderColor: color, boxShadow: `0 0 10px ${color}` } : {}} />;\r\n};\r\n\r\nexport const ShopScreen: React.FC<ShopScreenProps> = ({ onClose }) => {\r\n    const [tab, setTab] = useState<'OFFENSE' | 'DEFENSE' | 'UTILITY' | 'SKINS'>('OFFENSE');\r\n    const [shards, setShards] = useState(persistence.profile.shards);\r\n    const [upgrades, setUpgrades] = useState({ ...persistence.profile.upgrades });\r\n    const [unlockedSkins, setUnlockedSkins] = useState([...persistence.profile.unlockedSkins]);\r\n    const [equippedSkin, setEquippedSkin] = useState(persistence.profile.equippedSkin);\r\n\r\n    useEffect(() => {\r\n        audioSystem.playMusic('shop');\r\n        return () => {\r\n            // Music handling is now done in App.tsx onClose\r\n        };\r\n    }, []);\r\n\r\n    const buyUpgrade = (key: string) => {\r\n        const item = UPGRADE_CONFIG[key];\r\n        if (!item) return;\r\n        const current = upgrades[key] || 0;\r\n\r\n        if (current >= item.max) return;\r\n\r\n        const discountLevel = upgrades.discount || 0;\r\n        const discountMult = 1 - (discountLevel * 0.1);\r\n        const cost = Math.floor((item.costBase * Math.pow(item.costMult, current)) * discountMult);\r\n\r\n        if (shards >= cost) {\r\n            const newShards = shards - cost;\r\n            const newLevel = current + 1;\r\n\r\n            // Update Persistence\r\n            persistence.profile.shards = newShards;\r\n            persistence.profile.upgrades[key] = newLevel;\r\n            persistence.save();\r\n\r\n            // Update Local State\r\n            setShards(newShards);\r\n            setUpgrades(prev => ({ ...prev, [key]: newLevel }));\r\n\r\n            audioSystem.playPowerUp();\r\n        } else {\r\n            // audioSystem.playHeavy(); // Assuming playHeavy is error sound\r\n        }\r\n    };\r\n\r\n    const buySkin = (key: string) => {\r\n        const item = SKIN_CONFIG[key];\r\n\r\n        const applySkin = () => {\r\n            persistence.profile.equippedSkin = key;\r\n            persistence.save();\r\n            setEquippedSkin(key);\r\n            audioSystem.playPowerUp();\r\n        };\r\n\r\n        if (item.unlockReq) {\r\n            const reqMet = (item.unlockReq.type === 'score' && persistence.profile.highScore >= item.unlockReq.val) ||\r\n                (item.unlockReq.type === 'wave' && persistence.profile.maxWave >= item.unlockReq.val);\r\n\r\n            if (!reqMet && !unlockedSkins.includes(key)) {\r\n                // Locked\r\n                return;\r\n            }\r\n\r\n            if (reqMet && !unlockedSkins.includes(key)) {\r\n                // Unlock\r\n                persistence.profile.unlockedSkins.push(key);\r\n                persistence.save();\r\n                setUnlockedSkins(prev => [...prev, key]);\r\n                audioSystem.playPowerUp();\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (unlockedSkins.includes(key)) {\r\n            // Equip\r\n            applySkin();\r\n        } else {\r\n            // Buy\r\n            if (shards >= item.cost) {\r\n                const newShards = shards - item.cost;\r\n\r\n                persistence.profile.shards = newShards;\r\n                persistence.profile.unlockedSkins.push(key);\r\n                persistence.save();\r\n\r\n                setShards(newShards);\r\n                setUnlockedSkins(prev => [...prev, key]);\r\n                applySkin();\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div id=\"shop-screen\">\r\n            <div className=\"shop-container\">\r\n                <div className=\"shop-currency-floater\">\r\n                    <svg className=\"shard-icon\" style={{ width: '24px', height: '24px' }}><use xlinkHref=\"#icon-shard\" /></svg>\r\n                    <span>{shards}</span>\r\n                </div>\r\n                <div className=\"shop-header-container\">\r\n                    <h1 className=\"neon-header\" style={{ fontSize: '40px', color: '#b0f', textShadow: '0 0 20px #b0f' }}>BLACK MARKET</h1>\r\n                </div>\r\n                <div className=\"shop-tabs\" role=\"tablist\">\r\n                    {['OFFENSE', 'DEFENSE', 'UTILITY', 'SKINS'].map(t => (\r\n                        <button\r\n                            key={t}\r\n                            role=\"tab\"\r\n                            aria-selected={tab === t}\r\n                            className={`shop-tab ${tab === t ? 'active' : ''}`}\r\n                            onClick={() => setTab(t as any)}\r\n                        >\r\n                            {t}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n                <div className=\"shop-grid\">\r\n                    {tab === 'SKINS' ? (\r\n                        Object.entries(SKIN_CONFIG).map(([key, item]) => {\r\n                            const owned = unlockedSkins.includes(key);\r\n                            const equipped = equippedSkin === key;\r\n\r\n                            let isSecretLocked = false;\r\n                            if (item.unlockReq && !owned) {\r\n                                const reqMet = (item.unlockReq.type === 'score' && persistence.profile.highScore >= item.unlockReq.val) ||\r\n                                    (item.unlockReq.type === 'wave' && persistence.profile.maxWave >= item.unlockReq.val);\r\n                                if (!reqMet) isSecretLocked = true;\r\n                            }\r\n\r\n                            const affordable = shards >= item.cost;\r\n                            const displayName = (isSecretLocked && item.name === '???') ? '???' : (item.realName || item.name);\r\n\r\n                            return (\r\n                                <div key={key} className=\"shop-item\">\r\n                                    <div className=\"shop-item-title\">{displayName}</div>\r\n                                    <ShopItemIcon type={key} isSkin={true} color={item.colors.main} design={item.design} isSecret={isSecretLocked} />\r\n                                    <button\r\n                                        className={`buy-btn ${equipped ? 'equipped' : (owned ? 'equip' : (affordable && !isSecretLocked ? 'affordable' : 'locked'))}`}\r\n                                        onClick={() => buySkin(key)}\r\n                                    >\r\n                                        {equipped ? 'EQUIPPED' : (owned ? 'EQUIP' : (isSecretLocked ? item.unlockReq?.hint : (\r\n                                            <>\r\n                                                BUY {item.cost} <svg className=\"shard-icon\" style={{ width: '12px', height: '12px', fill: 'currentColor', display: 'inline-block', verticalAlign: 'middle', marginLeft: '4px' }}><use xlinkHref=\"#icon-shard\" /></svg>\r\n                                            </>\r\n                                        )))}\r\n                                    </button>\r\n                                </div>\r\n                            );\r\n                        })\r\n                    ) : (\r\n                        Object.entries(UPGRADE_CONFIG).filter(([_, item]) => item.cat === tab).map(([key, item]) => {\r\n                            const level = upgrades[key] || 0;\r\n                            const maxed = level >= item.max;\r\n\r\n                            const discountLevel = upgrades.discount || 0;\r\n                            const discountMult = 1 - (discountLevel * 0.1);\r\n                            const cost = Math.floor((item.costBase * Math.pow(item.costMult, level)) * discountMult);\r\n\r\n                            const affordable = !maxed && shards >= cost;\r\n\r\n                            return (\r\n                                <div key={key} className=\"shop-item\">\r\n                                    <div className=\"shop-item-title\">{item.name}</div>\r\n                                    <ShopItemIcon type={key} />\r\n                                    <div className=\"progress-bar\" role=\"progressbar\" aria-valuenow={level} aria-valuemin={0} aria-valuemax={item.max}>\r\n                                        {Array.from({ length: item.max }).map((_, i) => (\r\n                                            <div key={i} className={`progress-pip ${i < level ? (maxed ? 'maxed' : 'filled') : ''}`}></div>\r\n                                        ))}\r\n                                    </div>\r\n                                    <div className=\"shop-item-desc\">{item.desc}</div>\r\n                                    <button\r\n                                        className={`buy-btn ${maxed ? 'owned' : (affordable ? 'affordable' : 'locked')}`}\r\n                                        onClick={() => buyUpgrade(key)}\r\n                                        disabled={maxed || (!affordable)}\r\n                                    >\r\n                                        {maxed ? 'MAXED' : (\r\n                                            <>\r\n                                                <svg className=\"shard-icon\" style={{ width: '12px', height: '12px', fill: 'currentColor' }}><use xlinkHref=\"#icon-shard\" /></svg>\r\n                                                {cost}\r\n                                            </>\r\n                                        )}\r\n                                    </button>\r\n                                </div>\r\n                            );\r\n                        })\r\n                    )}\r\n                </div>\r\n                <div style={{ textAlign: 'center', marginTop: '10px' }}>\r\n                    <button className=\"main-btn\" style={{ fontSize: '16px', padding: '10px 30px', border: '2px solid #0ff', color: '#0ff', background: 'transparent', textShadow: '0 0 10px #0ff' }} onClick={onClose}>ALL SET!</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\screens\\StartScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\ui\\DialogueDisplay.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An empty interface declaration allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowInterfaces' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":4,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterface","endLine":4,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterface","data":{"replacement":"object"},"fix":{"range":[111,213],"text":"type DialogueDisplayProps = object"},"desc":"Replace empty interface with `object`."},{"messageId":"replaceEmptyInterface","data":{"replacement":"unknown"},"fix":{"range":[111,213],"text":"type DialogueDisplayProps = unknown"},"desc":"Replace empty interface with `unknown`."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":162,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":162,"endColumn":34}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport type { PilotId } from '../../game/config/PilotConfig';\r\n\r\ninterface DialogueDisplayProps {\r\n    // This component will be controlled via events from the game\r\n}\r\n\r\ninterface DialogueState {\r\n    visible: boolean;\r\n    text: string;\r\n    pilotName: string;\r\n    pilotIcon: string;\r\n    pilotColor: string;\r\n    pilotId: PilotId | null;\r\n}\r\n\r\nexport const DialogueDisplay: React.FC<DialogueDisplayProps> = () => {\r\n    const [dialogue, setDialogue] = useState<DialogueState>({\r\n        visible: false,\r\n        text: '',\r\n        pilotName: '',\r\n        pilotIcon: '',\r\n        pilotColor: '#0ff',\r\n        pilotId: null\r\n    });\r\n\r\n    const [fadeOut, setFadeOut] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Listen for dialogue events from the game\r\n        const handleDialogue = (e: CustomEvent<{\r\n            pilotId: PilotId;\r\n            text: string;\r\n            pilotName: string;\r\n            icon: string;\r\n            color: string;\r\n        }>) => {\r\n            setFadeOut(false);\r\n            setDialogue({\r\n                visible: true,\r\n                text: e.detail.text,\r\n                pilotName: e.detail.pilotName,\r\n                pilotIcon: e.detail.icon,\r\n                pilotColor: e.detail.color,\r\n                pilotId: e.detail.pilotId\r\n            });\r\n\r\n            // Auto-hide after 4 seconds\r\n            setTimeout(() => {\r\n                setFadeOut(true);\r\n                setTimeout(() => {\r\n                    setDialogue(prev => ({ ...prev, visible: false }));\r\n                }, 500);\r\n            }, 4000);\r\n        };\r\n\r\n        window.addEventListener('pilot-dialogue', handleDialogue as EventListener);\r\n        return () => window.removeEventListener('pilot-dialogue', handleDialogue as EventListener);\r\n    }, []);\r\n\r\n    if (!dialogue.visible) return null;\r\n\r\n    return (\r\n        <div\r\n            className={`dialogue-display ${fadeOut ? 'fade-out' : ''}`}\r\n            style={{\r\n                position: 'fixed',\r\n                bottom: '120px',\r\n                left: '50%',\r\n                transform: 'translateX(-50%)',\r\n                zIndex: 150,\r\n                pointerEvents: 'none',\r\n                animation: fadeOut ? 'fadeOut 0.5s ease-out forwards' : 'slideUp 0.3s ease-out'\r\n            }}\r\n        >\r\n            <div\r\n                className=\"dialogue-bubble\"\r\n                style={{\r\n                    background: 'rgba(0,0,0,0.85)',\r\n                    border: `2px solid ${dialogue.pilotColor}`,\r\n                    borderRadius: '15px',\r\n                    padding: '12px 20px',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '15px',\r\n                    maxWidth: '500px',\r\n                    boxShadow: `0 0 30px ${dialogue.pilotColor}40`\r\n                }}\r\n            >\r\n                <div\r\n                    className=\"pilot-avatar\"\r\n                    style={{\r\n                        width: '50px',\r\n                        height: '50px',\r\n                        borderRadius: '50%',\r\n                        background: `linear-gradient(135deg, ${dialogue.pilotColor}20, ${dialogue.pilotColor}40)`,\r\n                        border: `2px solid ${dialogue.pilotColor}`,\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        justifyContent: 'center',\r\n                        fontSize: '28px',\r\n                        flexShrink: 0\r\n                    }}\r\n                >\r\n                    {dialogue.pilotIcon}\r\n                </div>\r\n\r\n                <div className=\"dialogue-content\">\r\n                    <div\r\n                        className=\"pilot-name\"\r\n                        style={{\r\n                            color: dialogue.pilotColor,\r\n                            fontSize: '12px',\r\n                            fontWeight: 'bold',\r\n                            textTransform: 'uppercase',\r\n                            letterSpacing: '1px',\r\n                            marginBottom: '4px'\r\n                        }}\r\n                    >\r\n                        {dialogue.pilotName}\r\n                    </div>\r\n                    <div\r\n                        className=\"dialogue-text\"\r\n                        style={{\r\n                            color: '#fff',\r\n                            fontSize: '16px',\r\n                            lineHeight: 1.3\r\n                        }}\r\n                    >\r\n                        {dialogue.text}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <style>{`\r\n                @keyframes slideUp {\r\n                    from {\r\n                        opacity: 0;\r\n                        transform: translateX(-50%) translateY(20px);\r\n                    }\r\n                    to {\r\n                        opacity: 1;\r\n                        transform: translateX(-50%) translateY(0);\r\n                    }\r\n                }\r\n                @keyframes fadeOut {\r\n                    from {\r\n                        opacity: 1;\r\n                        transform: translateX(-50%) translateY(0);\r\n                    }\r\n                    to {\r\n                        opacity: 0;\r\n                        transform: translateX(-50%) translateY(-10px);\r\n                    }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Helper function to trigger dialogue from anywhere in the codebase\r\nexport function showPilotDialogue(\r\n    pilotId: PilotId,\r\n    text: string,\r\n    pilotName: string,\r\n    icon: string,\r\n    color: string\r\n) {\r\n    window.dispatchEvent(new CustomEvent('pilot-dialogue', {\r\n        detail: { pilotId, text, pilotName, icon, color }\r\n    }));\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\ui\\HUD.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\components\\ui\\Icons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\AchievementConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\BossConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\CurrencyConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\DailyRewardsConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\PilotConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\PilotDialogueConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\ShopConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\config\\StoryConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\core\\GameEngine.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2706,2709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2706,2709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":466,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":466,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19232,19235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19232,19235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":511,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":511,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21371,21374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21371,21374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { audioSystem } from '../systems/AudioSystem';\r\nimport { spriteCache } from '../systems/SpriteCache';\r\nimport { persistence } from '../systems/Persistence';\r\nimport { inputSystem } from '../systems/InputSystem';\r\nimport { tutorialSystem } from '../systems/TutorialSystem';\r\nimport { assistPilot } from '../systems/AssistPilot';\r\nimport { showPilotDialogue } from '../../components/ui/DialogueDisplay';\r\nimport { getDialogue } from '../config/PilotDialogueConfig';\r\nimport { PILOT_CLASSES, type PilotId } from '../config/PilotConfig';\r\nimport { Pool } from './Pool';\r\nimport { SpatialGrid } from './SpatialGrid';\r\nimport { Ship } from '../entities/Ship';\r\nimport { Asteroid } from '../entities/Asteroid';\r\nimport { Bullet } from '../entities/Bullet';\r\nimport { Particle } from '../entities/Particle';\r\nimport { FloatingText } from '../entities/FloatingText';\r\nimport { PowerUp } from '../entities/PowerUp';\r\nimport { Boss } from '../entities/Boss';\r\nimport { SKIN_CONFIG } from '../config/ShopConfig';\r\nimport { getBossForWave, MAX_WAVES } from '../config/BossConfig';\r\n\r\nexport type GameState = 'START' | 'PLAYING' | 'PAUSED' | 'GAMEOVER' | 'VICTORY';\r\n\r\ninterface UICallbacks {\r\n    onScoreUpdate: (score: number) => void;\r\n    onWaveUpdate: (wave: number, subText: string, hintText: string, isBoss: boolean) => void;\r\n    onLivesUpdate: (lives: number, shields: number) => void;\r\n    onWeaponUpdate: (weapon: string) => void;\r\n    onComboUpdate: (combo: number, val: number) => void;\r\n    onGameOver: (score: number, highScore: number, isNewHighScore: boolean) => void;\r\n    onVictory?: (score: number, highScore: number) => void;\r\n    onGameStart: () => void;\r\n    onPause: (isPaused: boolean) => void;\r\n}\r\n\r\nexport class GameEngine {\r\n    public canvas: HTMLCanvasElement | null = null;\r\n    public ctx: CanvasRenderingContext2D | null = null;\r\n    public ship: Ship | null = null;\r\n    public boss: Boss | null = null;\r\n    public bullets: Bullet[] = [];\r\n    public asteroids: Asteroid[] = [];\r\n    public particles: Particle[] = [];\r\n    public floatingTexts: FloatingText[] = [];\r\n    public powerups: PowerUp[] = [];\r\n    public score: number = 0;\r\n    public gameState: GameState = 'START';\r\n    public tutorialSystem = tutorialSystem;\r\n\r\n    public lives: number = 3;\r\n    public wave: number = 1;\r\n    public combo: number = 1;\r\n    public comboTimer: number = 0;\r\n\r\n    private lastTime: number = 0;\r\n\r\n    private interestTimer: number = 0;\r\n    private regenTimer: number = 0;\r\n    private hasRevived: boolean = false;\r\n\r\n    private bulletPool: Pool<Bullet>;\r\n    private particlePool: Pool<Particle>;\r\n    private textPool: Pool<FloatingText>;\r\n    private spatialGrid: SpatialGrid<any>; // Using any for the wrapper object\r\n\r\n    private uiCallbacks: UICallbacks | null = null;\r\n\r\n    // Funny texts\r\n    private funnyWaveIntros = [\"INITIALIZING SYSTEMS...\", \"HYPERSPACE ENGAGED\", \"ASTEROID FIELD AHEAD\", \"DON'T BLINK\", \"STAY SHARP PILOT\", \"MORE ROCKS? REALLY?\", \"CLEAN UP ON AISLE 5\", \"THEY SEE ME ROLLIN'\", \"WATCH YOUR SIX\", \"INCOMING SPACE TRASH\", \"PIZZA DELIVERY IS LATE\"];\r\n    private funnyBossIntros = [\"WARNING: DREADNOUGHT DETECTED\", \"BOSS APPROACHING\", \"WARNING: BIG SHIP ENERGY\", \"OH NO, IT'S THE MANAGER\", \"GIANT ENEMY CRAB... WAIT\", \"PREPARE FOR TROUBLE\", \"LEVEL 9000 BOSS DETECTED\", \"IT'S BOSS O'CLOCK\"];\r\n    private hints = [\"Tip: Use SHIFT to DASH.\", \"Tip: Heavy ammo pierces.\", \"Tip: Upgrades are permanent.\", \"Tip: Nukes clear screen.\", \"Tip: Collect SHARDS.\", \"Tip: Kill fast for combos.\"];\r\n\r\n    constructor() {\r\n        this.bulletPool = new Pool(() => new Bullet(), (b, x, y, a, t, d, p, s, h) => b.init(x, y, a, t, d, p, s, h));\r\n        this.particlePool = new Pool(() => new Particle(), (p, x, y, c) => p.init(x, y, c));\r\n        this.textPool = new Pool(() => new FloatingText(), (t, x, y, txt, c) => t.init(x, y, txt, c));\r\n        // Initialize with a reasonable cell size (e.g., 100px)\r\n        this.spatialGrid = new SpatialGrid(2000, 2000, 100);\r\n    }\r\n\r\n    public init(canvas: HTMLCanvasElement, callbacks: UICallbacks) {\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        this.uiCallbacks = callbacks;\r\n\r\n        spriteCache.init();\r\n        audioSystem.init();\r\n        persistence.load();\r\n        tutorialSystem.init();\r\n\r\n        // Listen for profile updates (e.g. skin change)\r\n        window.addEventListener('profile-updated', ((e: CustomEvent<{ equippedSkin?: string }>) => {\r\n            if (this.ship && e.detail && e.detail.equippedSkin) {\r\n                const skinData = SKIN_CONFIG[e.detail.equippedSkin];\r\n                if (skinData) {\r\n                    this.ship.skin = skinData;\r\n                }\r\n            }\r\n        }) as EventListener);\r\n\r\n        // Input callbacks\r\n        inputSystem.setCallbacks({\r\n            onPause: () => this.togglePause(),\r\n            onDash: () => {\r\n                if (this.ship) this.ship.dash();\r\n            },\r\n            onSwap: () => {\r\n                if (this.ship && this.gameState === 'PLAYING') {\r\n                    this.ship.switchWeapon({\r\n                        spawnBullet: this.spawnBullet.bind(this),\r\n                        spawnParticle: this.spawnParticle.bind(this),\r\n                        spawnText: this.spawnText.bind(this),\r\n                        updateWeaponUI: (t) => this.uiCallbacks?.onWeaponUpdate(t),\r\n                        updateHUD: this.updateHUD.bind(this),\r\n                        gameOver: this.gameOver.bind(this)\r\n                    });\r\n                    if (tutorialSystem.active) tutorialSystem.checkSwap();\r\n                }\r\n            }\r\n        });\r\n\r\n        inputSystem.attachTouchListeners(canvas);\r\n\r\n        this.resize();\r\n        window.addEventListener('resize', () => this.resize());\r\n\r\n        // Start loop\r\n        this.lastTime = 0;\r\n        this.loop(0);\r\n    }\r\n\r\n    private resize() {\r\n        if (this.canvas) {\r\n            this.canvas.width = window.innerWidth;\r\n            this.canvas.height = window.innerHeight;\r\n        }\r\n    }\r\n\r\n    public startGame() {\r\n        if (!this.canvas) return;\r\n\r\n        this.score = 0;\r\n        if ((persistence.profile.upgrades.start || 0) > 0) {\r\n            this.wave = 4;\r\n            this.score = 1000;\r\n            persistence.addShards(50);\r\n        } else {\r\n            this.wave = 1;\r\n        }\r\n\r\n        // CRITICAL: Set gameState to 'PLAYING' so the game loop runs!\r\n        this.gameState = 'PLAYING';\r\n\r\n        this.ship = new Ship(this.bulletPool);\r\n\r\n        // Apply current skin\r\n        const skinKey = persistence.profile.equippedSkin || 'default';\r\n        const skinData = SKIN_CONFIG[skinKey];\r\n        if (skinData) this.ship.skin = skinData;\r\n\r\n        this.lives = this.ship.maxLives;\r\n        this.hasRevived = false;\r\n\r\n        this.bullets = [];\r\n        this.asteroids = [];\r\n        this.particles = [];\r\n        if (this.wave === 1) {\r\n            // Reset ship with no invincibility for tutorial so it's always visible\r\n            this.ship.reset(this.canvas.width, this.canvas.height, 0);\r\n            tutorialSystem.start();\r\n            this.uiCallbacks?.onWaveUpdate(1, \"TUTORIAL\", \"Follow instructions\", false);\r\n            // Tutorial system will spawn asteroid when needed (at shoot step)\r\n        } else {\r\n            // Reset ship with normal invincibility\r\n            this.ship.reset(this.canvas.width, this.canvas.height);\r\n            this.spawnWave();\r\n        }\r\n    }\r\n\r\n    public togglePause() {\r\n        if (this.gameState === 'PLAYING') {\r\n            this.gameState = 'PAUSED';\r\n            audioSystem.pauseMusic();\r\n            if (tutorialSystem.active) tutorialSystem.checkPause();\r\n            this.uiCallbacks?.onPause(true);\r\n        } else if (this.gameState === 'PAUSED') {\r\n            this.gameState = 'PLAYING';\r\n            audioSystem.resumeMusic();\r\n            this.lastTime = 0; // Reset delta\r\n            this.uiCallbacks?.onPause(false);\r\n        }\r\n    }\r\n\r\n    public spawnTutorialAsteroid(x: number, y: number) {\r\n        if (!this.canvas) return;\r\n        const asteroid = new Asteroid(x, y, 'large', this.canvas.width, this.canvas.height, this.getGameCallbacks());\r\n        asteroid.vx = 0;\r\n        asteroid.vy = 0;\r\n        this.asteroids.push(asteroid);\r\n    }\r\n\r\n    public spawnWave() {\r\n        if (!this.canvas) return;\r\n\r\n        // Check if this is a boss wave using the config\r\n        const bossConfig = getBossForWave(this.wave);\r\n        const isBossWaveNow = bossConfig !== undefined;\r\n\r\n        // Calculate asteroid count (no asteroids on boss waves)\r\n        let count = 3 + Math.floor(this.wave * 0.8);\r\n        count = Math.min(count, 15);\r\n        if (this.wave <= 2) count = this.wave;\r\n        else if (isBossWaveNow) count = 0;\r\n\r\n        Asteroid.currentWave = this.wave;\r\n        this.asteroids = [];\r\n        for (let i = 0; i < count; i++) {\r\n            this.asteroids.push(new Asteroid(undefined, undefined, 'large', this.canvas.width, this.canvas.height, this.getGameCallbacks()));\r\n        }\r\n\r\n        // Generate wave text\r\n        let subText: string;\r\n        let hintText: string;\r\n\r\n        if (bossConfig) {\r\n            // Boss wave - show boss name\r\n            subText = bossConfig.isFinalBoss\r\n                ? `FINAL BOSS: ${bossConfig.name}`\r\n                : `BOSS: ${bossConfig.name}`;\r\n            hintText = bossConfig.isFinalBoss\r\n                ? \"DEFEAT THE MOTHERSHIP!\"\r\n                : this.funnyBossIntros[Math.floor(Math.random() * this.funnyBossIntros.length)];\r\n        } else {\r\n            subText = this.funnyWaveIntros[Math.floor(Math.random() * this.funnyWaveIntros.length)];\r\n            hintText = this.wave === 1 ? \"Tip: Kill fast to build COMBO multiplier!\" : this.hints[Math.floor(Math.random() * this.hints.length)];\r\n        }\r\n\r\n        // Spawn boss if this is a boss wave\r\n        if (bossConfig) {\r\n            this.boss = new Boss(bossConfig, this.wave, this.canvas.width);\r\n            audioSystem.playAlarm();\r\n            audioSystem.playMusic('boss');\r\n\r\n            // Trigger assist pilot on wave 3 (first boss) automatically\r\n            if (this.wave === 3) {\r\n                const playerPilotId = (persistence.profile.selectedPilot || 'striker') as PilotId;\r\n                this.activateAssistPilot(playerPilotId);\r\n            }\r\n        } else {\r\n            this.boss = null;\r\n            audioSystem.playMusic('wave');\r\n        }\r\n\r\n        // Show player pilot wave start dialogue\r\n        const playerPilotId = (persistence.profile.selectedPilot || 'striker') as PilotId;\r\n        const pilot = PILOT_CLASSES[playerPilotId];\r\n        if (pilot) {\r\n            const eventType = bossConfig ? 'bossAlert' : 'waveStart';\r\n            const dialogue = getDialogue(playerPilotId, eventType);\r\n            setTimeout(() => {\r\n                showPilotDialogue(playerPilotId, dialogue, pilot.name, pilot.icon, pilot.color);\r\n            }, 1500);  // Slight delay so it doesn't overlap with wave announcement\r\n        }\r\n\r\n        this.uiCallbacks?.onWaveUpdate(this.wave, subText, hintText, isBossWaveNow);\r\n    }\r\n\r\n    // Activate assist pilot\r\n    private activateAssistPilot(playerPilotId: PilotId) {\r\n        if (!this.canvas || !this.ship) return;\r\n\r\n        assistPilot.activate(\r\n            playerPilotId,\r\n            this.canvas.width,\r\n            this.canvas.height,\r\n            {\r\n                onDialogue: (pilotId, text, pilotName, icon, color) => {\r\n                    showPilotDialogue(pilotId, text, pilotName, icon, color);\r\n                },\r\n                onAssistStart: () => {\r\n                    // Could trigger UI update\r\n                },\r\n                onAssistEnd: () => {\r\n                    // Assist ended\r\n                },\r\n                spawnBullet: (x, y, angle, type, damage) => {\r\n                    const b = this.bulletPool.get(x, y, angle, type, damage, 1, 2, false);\r\n                    this.bullets.push(b);\r\n                }\r\n            },\r\n            15  // 15 second duration\r\n        );\r\n    }\r\n\r\n    private loop(timestamp: number) {\r\n        requestAnimationFrame(this.loop.bind(this));\r\n\r\n        if (this.gameState !== 'PLAYING') return;\r\n        if (!this.lastTime) this.lastTime = timestamp;\r\n        const dt = Math.min((timestamp - this.lastTime) / 1000, 0.1);\r\n        this.lastTime = timestamp;\r\n\r\n        this.update(dt);\r\n        this.draw();\r\n    }\r\n\r\n    private update(dt: number) {\r\n        if (!this.canvas || !this.ship) return;\r\n\r\n        // Regen\r\n        if ((persistence.profile.upgrades.regen || 0) > 0 && this.lives < this.ship.maxLives) {\r\n            this.regenTimer += dt;\r\n            if (this.regenTimer > 15) {\r\n                this.lives++;\r\n                this.regenTimer = 0;\r\n                this.updateHUD();\r\n                this.spawnText(this.ship.x, this.ship.y - 20, \"REPAIR\", \"#0f0\");\r\n            }\r\n        }\r\n\r\n        // Interest\r\n        if ((persistence.profile.upgrades.interest || 0) > 0) {\r\n            this.interestTimer += dt;\r\n            if (this.interestTimer > 5) {\r\n                const income = persistence.profile.upgrades.interest * 2;\r\n                persistence.addShards(income);\r\n                this.interestTimer = 0;\r\n                this.spawnText(this.ship.x, this.ship.y + 20, `+${income}`, \"#0f0\");\r\n            }\r\n        }\r\n\r\n        // Combo\r\n        if (this.combo > 1) {\r\n            this.comboTimer -= dt;\r\n            const maxTime = 2.5 + ((persistence.profile.upgrades.combo || 0) * 0.5);\r\n            this.uiCallbacks?.onComboUpdate(this.combo, this.comboTimer / maxTime);\r\n            if (this.comboTimer <= 0) {\r\n                this.combo = 1;\r\n                this.updateHUD();\r\n            }\r\n        }\r\n\r\n        // Assist Pilot update\r\n        if (assistPilot.active) {\r\n            const enemyPositions = [\r\n                ...this.asteroids.map(a => ({ x: a.x, y: a.y })),\r\n                ...(this.boss ? [{ x: this.boss.x, y: this.boss.y }] : [])\r\n            ];\r\n            assistPilot.update(\r\n                dt,\r\n                this.ship.x,\r\n                this.ship.y,\r\n                this.canvas.width,\r\n                this.canvas.height,\r\n                enemyPositions\r\n            );\r\n        }\r\n\r\n        // Entities\r\n        this.ship.update(dt, inputSystem.keys, inputSystem.touchSticks, this.canvas.width, this.canvas.height, {\r\n            spawnBullet: this.spawnBullet.bind(this),\r\n            spawnParticle: this.spawnParticle.bind(this),\r\n            spawnText: this.spawnText.bind(this),\r\n            updateWeaponUI: (t) => this.uiCallbacks?.onWeaponUpdate(t),\r\n            updateHUD: this.updateHUD.bind(this),\r\n            gameOver: this.gameOver.bind(this)\r\n        }, this.combo);\r\n\r\n        if (tutorialSystem.active) {\r\n            tutorialSystem.checkMove(this.ship.x, this.ship.y);\r\n            tutorialSystem.checkRotate(this.ship.angle);\r\n        }\r\n\r\n        for (let i = this.bullets.length - 1; i >= 0; i--) {\r\n            const b = this.bullets[i];\r\n            b.update(dt, this.asteroids);\r\n            if (!b.active || b.x < 0 || b.x > this.canvas.width || b.y < 0 || b.y > this.canvas.height) {\r\n                this.bulletPool.release(b);\r\n                // Swap and Pop\r\n                this.bullets[i] = this.bullets[this.bullets.length - 1];\r\n                this.bullets.pop();\r\n                // Since we iterate backwards, we don't need to decrement i?\r\n                // Wait, if we swap the last element to position i, we have already processed the last element (since we go backwards).\r\n                // So the swapped element HAS been processed.\r\n                // So we don't need to re-process it.\r\n                // Correct.\r\n                continue;\r\n            }\r\n        }\r\n\r\n        if (this.boss && !this.boss.dead) {\r\n            this.boss.update(dt, {\r\n                spawnBullet: (x, y, a, t, d) => {\r\n                    const b = this.bulletPool.get(x, y, a, t, d, 1, 4, false);\r\n                    this.bullets.push(b);\r\n                },\r\n                getPlayerPosition: () => ({\r\n                    x: this.ship?.x || this.canvas!.width / 2,\r\n                    y: this.ship?.y || this.canvas!.height / 2\r\n                })\r\n            }, this.wave);\r\n        }\r\n\r\n        // Check for wave completion\r\n        if (!tutorialSystem.active && this.asteroids.length === 0 && (!this.boss || this.boss.dead)) {\r\n            // Check if game is complete (wave 20 boss defeated)\r\n            if (this.wave >= MAX_WAVES && this.boss?.dead) {\r\n                this.victory();\r\n                return;\r\n            }\r\n            this.wave++;\r\n            this.spawnWave();\r\n        }\r\n\r\n        for (let i = this.asteroids.length - 1; i >= 0; i--) {\r\n            const a = this.asteroids[i];\r\n            a.update(dt, this.canvas.width, this.canvas.height);\r\n            if (a.dead) {\r\n                this.asteroids[i] = this.asteroids[this.asteroids.length - 1];\r\n                this.asteroids.pop();\r\n            }\r\n        }\r\n\r\n        for (let i = this.powerups.length - 1; i >= 0; i--) {\r\n            const p = this.powerups[i];\r\n            p.update(dt, this.ship.x, this.ship.y, this.ship.dead);\r\n            if (!p.active) {\r\n                this.powerups[i] = this.powerups[this.powerups.length - 1];\r\n                this.powerups.pop();\r\n                continue;\r\n            }\r\n            const d = (p.x - this.ship.x) ** 2 + (p.y - this.ship.y) ** 2;\r\n            if (d < (p.radius + this.ship.radius) ** 2) {\r\n                p.active = false;\r\n                audioSystem.playPowerUp();\r\n                if (p.type === 'SHIELD') {\r\n                    this.ship.shields++;\r\n                    this.updateHUD();\r\n                    this.spawnText(this.ship.x, this.ship.y - 20, \"SHIELD\", \"#0ff\");\r\n                } else if (p.type === 'NUKE') {\r\n                    this.asteroids.forEach(a => a.break(this.getGameCallbacks(), this.asteroids, this.combo));\r\n                    if (this.boss) {\r\n                        this.boss.hp -= 50;\r\n                        if (this.boss.hp <= 0) {\r\n                            this.boss.dead = true;\r\n                            persistence.addShards(100);\r\n                            audioSystem.playExplosion('large');\r\n                            audioSystem.playMusic('wave');\r\n                        }\r\n                    }\r\n                    audioSystem.playNuke();\r\n                    this.spawnText(this.ship.x, this.ship.y - 20, \"NUKE\", \"#f00\");\r\n                } else if (p.type === 'SPEED') {\r\n                    this.ship.speedBoostTime = 10;\r\n                    this.spawnText(this.ship.x, this.ship.y - 20, \"SPEED UP\", \"#ff0\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Collision Logic (Optimized with Spatial Grid)\r\n        // 1. Clear and Populate Grid\r\n        this.spatialGrid.clear();\r\n        for (const a of this.asteroids) {\r\n            // Asteroid needs to satisfy SpatialObject interface\r\n            // Assuming Asteroid has x, y, r (radius)\r\n            this.spatialGrid.insert({ x: a.x, y: a.y, radius: a.r, ref: a } as any);\r\n        }\r\n\r\n        // 2. Bullets vs Enemies (Asteroids & Boss)\r\n        for (const b of this.bullets) {\r\n            if (!b.active) continue;\r\n\r\n            if (b.isEnemy) {\r\n                // Enemy bullets vs Ship\r\n                if (this.ship.invincibleTime <= 0 && !this.ship.isDashing) {\r\n                    const d = (b.x - this.ship.x) ** 2 + (b.y - this.ship.y) ** 2;\r\n                    if (d < (b.radius + this.ship.radius) ** 2) {\r\n                        b.active = false;\r\n                        if (this.ship.hit({\r\n                            spawnBullet: this.spawnBullet.bind(this),\r\n                            spawnParticle: this.spawnParticle.bind(this),\r\n                            spawnText: this.spawnText.bind(this),\r\n                            updateWeaponUI: (t) => this.uiCallbacks?.onWeaponUpdate(t),\r\n                            updateHUD: this.updateHUD.bind(this),\r\n                            gameOver: this.gameOver.bind(this)\r\n                        })) {\r\n                            this.handlePlayerHit();\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                // Player bullets vs Boss\r\n                if (this.boss && !this.boss.dead) {\r\n                    const d = (b.x - this.boss.x) ** 2 + (b.y - this.boss.y) ** 2;\r\n                    if (d < 3600) { // Boss radius approx 60\r\n                        this.boss.hp -= b.damage;\r\n                        b.active = false;\r\n                        if (this.boss.hp <= 0) {\r\n                            this.boss.dead = true;\r\n                            audioSystem.playExplosion('large');\r\n                            persistence.addShards(50);\r\n                            audioSystem.playMusic('wave');\r\n                        }\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                // Player bullets vs Asteroids (Grid Query)\r\n                this.spatialGrid.query(b.x, b.y, b.radius, (item) => {\r\n                    if (!b.active) return; // Bullet might have died in previous callback\r\n                    const a = (item as any).ref as Asteroid;\r\n                    // Double check distance (broad phase -> narrow phase)\r\n                    const d = (b.x - a.x) ** 2 + (b.y - a.y) ** 2;\r\n                    if (d < (a.r + b.radius) ** 2) {\r\n                        a.hit(b.damage, b.vx, b.vy, this.getGameCallbacks(), this.asteroids, this.combo);\r\n                        b.pierce--;\r\n                        if (b.pierce <= 0) b.active = false;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        // Particles & Texts\r\n        for (let i = this.particles.length - 1; i >= 0; i--) {\r\n            const p = this.particles[i];\r\n            p.update(dt);\r\n            if (!p.active) {\r\n                this.particlePool.release(p);\r\n                this.particles[i] = this.particles[this.particles.length - 1];\r\n                this.particles.pop();\r\n            }\r\n        }\r\n        for (let i = this.floatingTexts.length - 1; i >= 0; i--) {\r\n            const t = this.floatingTexts[i];\r\n            t.update(dt);\r\n            if (!t.active) {\r\n                this.textPool.release(t);\r\n                this.floatingTexts[i] = this.floatingTexts[this.floatingTexts.length - 1];\r\n                this.floatingTexts.pop();\r\n            }\r\n        }\r\n    }\r\n\r\n    private draw() {\r\n        if (!this.ctx || !this.canvas) return;\r\n\r\n        this.ctx.fillStyle = '#050505';\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n        this.ship?.draw(this.ctx);\r\n        assistPilot.draw(this.ctx);  // Draw assist pilot\r\n        this.bullets.forEach(b => b.draw(this.ctx!));\r\n        this.boss?.draw(this.ctx);\r\n        this.asteroids.forEach(a => a.draw(this.ctx!));\r\n        this.powerups.forEach(p => p.draw(this.ctx!));\r\n        this.particles.forEach(p => p.draw(this.ctx!));\r\n        this.floatingTexts.forEach(t => t.draw(this.ctx!));\r\n    }\r\n\r\n    private handlePlayerHit() {\r\n        this.lives--;\r\n        this.combo = 1;\r\n        this.updateHUD();\r\n        const invTime = 2.0 + ((persistence.profile.upgrades.shieldDur || 0) * 0.5);\r\n        if (this.ship) {\r\n            this.ship.reset(this.canvas!.width, this.canvas!.height, invTime);\r\n        }\r\n        audioSystem.playExplosion('large');\r\n\r\n        // Nova Logic\r\n        if ((persistence.profile.upgrades.nova || 0) > 0) {\r\n            this.asteroids.forEach(a => {\r\n                a.hp -= 5; // Massive damage\r\n                if (a.hp <= 0) a.break(this.getGameCallbacks(), this.asteroids, this.combo);\r\n            });\r\n            if (this.boss) {\r\n                this.boss.hp -= 50;\r\n                if (this.boss.hp <= 0) {\r\n                    this.boss.dead = true;\r\n                    persistence.addShards(100);\r\n                    audioSystem.playExplosion('large');\r\n                    audioSystem.playMusic('wave');\r\n                }\r\n            }\r\n            audioSystem.playNuke(); // Reuse Nuke sound\r\n            this.spawnText(this.ship!.x, this.ship!.y - 40, \"NOVA!\", \"#f00\");\r\n        }\r\n\r\n        if (this.lives <= 0) this.gameOver();\r\n    }\r\n\r\n    private gameOver() {\r\n        if ((persistence.profile.upgrades.revive || 0) > 0 && !this.hasRevived) {\r\n            this.hasRevived = true;\r\n            this.lives = this.ship!.maxLives;\r\n            this.ship!.reset(this.canvas!.width, this.canvas!.height);\r\n            this.ship!.invincibleTime = 3.0;\r\n            this.updateHUD();\r\n            audioSystem.playPowerUp();\r\n            this.spawnText(this.ship!.x, this.ship!.y - 40, \"SYSTEM RESTORED\", \"#0ff\");\r\n            return;\r\n        }\r\n        this.gameState = 'GAMEOVER';\r\n        audioSystem.playMusic('load');\r\n\r\n        let isNewHighScore = false;\r\n        if (this.score > persistence.profile.highScore) {\r\n            persistence.profile.highScore = this.score;\r\n            isNewHighScore = true;\r\n        }\r\n        if (this.wave > persistence.profile.maxWave) persistence.profile.maxWave = this.wave;\r\n        persistence.save();\r\n\r\n        this.uiCallbacks?.onGameOver(this.score, persistence.profile.highScore, isNewHighScore);\r\n    }\r\n\r\n    private victory() {\r\n        this.gameState = 'VICTORY';\r\n        audioSystem.playPowerUp(); // Victory sound\r\n\r\n        // Big bonus for completing all 20 waves\r\n        const victoryBonus = 500;\r\n        persistence.addShards(victoryBonus);\r\n        this.score += victoryBonus * 10;\r\n\r\n        // Update stats\r\n        let isNewHighScore = false;\r\n        if (this.score > persistence.profile.highScore) {\r\n            persistence.profile.highScore = this.score;\r\n            isNewHighScore = true;\r\n        }\r\n        if (this.wave > persistence.profile.maxWave) persistence.profile.maxWave = this.wave;\r\n        persistence.save();\r\n\r\n        // Trigger victory callback or fall back to game over\r\n        if (this.uiCallbacks?.onVictory) {\r\n            this.uiCallbacks.onVictory(this.score, persistence.profile.highScore);\r\n        } else {\r\n            // Fallback: use game over with victory flag implied by state\r\n            this.uiCallbacks?.onGameOver(this.score, persistence.profile.highScore, isNewHighScore);\r\n        }\r\n    }\r\n\r\n    private updateHUD() {\r\n        this.uiCallbacks?.onLivesUpdate(this.lives, this.ship?.shields || 0);\r\n        this.uiCallbacks?.onScoreUpdate(this.score);\r\n        this.uiCallbacks?.onComboUpdate(this.combo, 0);\r\n    }\r\n\r\n    private spawnBullet(b: Bullet) {\r\n        this.bullets.push(b);\r\n        if (tutorialSystem.active) tutorialSystem.checkShoot();\r\n    }\r\n    private spawnParticle(x: number, y: number, c: string) { this.particles.push(this.particlePool.get(x, y, c)); }\r\n    private spawnText(x: number, y: number, t: string, c: string) { this.floatingTexts.push(this.textPool.get(x, y, t, c)); }\r\n\r\n    private getGameCallbacks() {\r\n        return {\r\n            spawnParticle: this.spawnParticle.bind(this),\r\n            spawnText: this.spawnText.bind(this),\r\n            spawnPowerUp: (p: PowerUp) => this.powerups.push(p),\r\n            spawnAsteroid: (x: number, y: number, size: string) => {\r\n                this.asteroids.push(new Asteroid(x, y, size, this.canvas!.width, this.canvas!.height, this.getGameCallbacks()));\r\n            },\r\n            onScore: (amount: number) => {\r\n                this.score += amount;\r\n                this.uiCallbacks?.onScoreUpdate(this.score);\r\n            },\r\n            onCombo: () => {\r\n                this.combo++;\r\n                this.comboTimer = 2.5 + ((persistence.profile.upgrades.combo || 0) * 0.5);\r\n                audioSystem.playComboUp(this.combo);\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\nexport const gameEngine = new GameEngine();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\core\\Pool.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[194,197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[194,197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[248,251],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[248,251],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[333,336],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[333,336],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[374,377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[374,377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[520,523],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[520,523],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\core\\SpatialGrid.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\Asteroid.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_callbacks' is defined but never used.","line":35,"column":120,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":130}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { spriteCache } from '../systems/SpriteCache';\r\nimport { persistence } from '../systems/Persistence';\r\nimport { audioSystem } from '../systems/AudioSystem';\r\nimport { PowerUp } from './PowerUp';\r\nimport { tutorialSystem } from '../systems/TutorialSystem';\r\n\r\n// We need to pass spawn functions from GameEngine to avoid circular dependencies or use a global event system.\r\n// For now, I'll define interfaces for the callbacks.\r\n\r\ninterface GameCallbacks {\r\n    spawnParticle: (x: number, y: number, color: string) => void;\r\n    spawnText: (x: number, y: number, text: string, color: string) => void;\r\n    spawnPowerUp: (p: PowerUp) => void;\r\n    spawnAsteroid: (x: number, y: number, size: string) => void;\r\n    onScore: (amount: number) => void;\r\n    onCombo: () => void;\r\n}\r\n\r\nexport class Asteroid {\r\n    public x: number = 0;\r\n    public y: number = 0;\r\n    public angle: number = 0;\r\n    public sizeStr: string;\r\n    public r: number;\r\n    public hp: number;\r\n    public col: string;\r\n    public vx: number = 0;\r\n    public vy: number = 0;\r\n    public sprite: HTMLCanvasElement;\r\n    public dead: boolean = false;\r\n\r\n    // Static wave reference (hacky but matches legacy global)\r\n    public static currentWave: number = 1;\r\n\r\n    constructor(x: number | undefined, y: number | undefined, size: string, canvasWidth: number, canvasHeight: number, _callbacks: GameCallbacks) {\r\n        this.sizeStr = size;\r\n        if (size === 'large') { this.r = 50; this.hp = 3; }\r\n        else if (size === 'medium') { this.r = 25; this.hp = 2; }\r\n        else { this.r = 12; this.hp = 1; }\r\n\r\n        const levelColors = ['#f0f', '#0f0', '#fa0', '#0ff', '#f00'];\r\n        this.col = levelColors[(Asteroid.currentWave - 1) % levelColors.length];\r\n\r\n        if (x === undefined) {\r\n            const edge = Math.random() < 0.5;\r\n            if (edge) {\r\n                this.x = Math.random() < 0.5 ? -50 : canvasWidth + 50;\r\n                this.y = Math.random() * canvasHeight;\r\n            } else {\r\n                this.x = Math.random() * canvasWidth;\r\n                this.y = Math.random() < 0.5 ? -50 : canvasHeight + 50;\r\n            }\r\n            const targetX = Math.random() * (canvasWidth * 0.8) + (canvasWidth * 0.1);\r\n            const targetY = Math.random() * (canvasHeight * 0.8) + (canvasHeight * 0.1);\r\n            this.angle = Math.atan2(targetY - this.y, targetX - this.x) + (Math.random() - 0.5) * 0.5;\r\n        } else {\r\n            this.x = x;\r\n            this.y = y!;\r\n            this.angle = Math.random() * Math.PI * 2;\r\n        }\r\n\r\n        const baseSpeed = Math.random() * 40 + 20;\r\n        const waveMult = 1 + Math.min(Asteroid.currentWave * 0.04, 1.0);\r\n        const slowMult = 1 - ((persistence.profile.upgrades.time || 0) * 0.15);\r\n        const spd = baseSpeed * waveMult * slowMult;\r\n        this.vx = Math.cos(this.angle) * spd;\r\n        this.vy = Math.sin(this.angle) * spd;\r\n        this.sprite = spriteCache.getAsteroid(size, this.col);\r\n    }\r\n\r\n    public update(dt: number, canvasWidth: number, canvasHeight: number) {\r\n        this.x += this.vx * dt;\r\n        this.y += this.vy * dt;\r\n        if (this.x < -60) this.x = canvasWidth + 60;\r\n        if (this.x > canvasWidth + 60) this.x = -60;\r\n        if (this.y < -60) this.y = canvasHeight + 60;\r\n        if (this.y > canvasHeight + 60) this.y = -60;\r\n    }\r\n\r\n    public draw(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.translate(this.x, this.y);\r\n        ctx.drawImage(this.sprite, -this.sprite.width / 2, -this.sprite.height / 2);\r\n        ctx.restore();\r\n    }\r\n\r\n    public hit(dmg: number, bulletVx: number, bulletVy: number, callbacks: GameCallbacks, allAsteroids: Asteroid[], combo: number) {\r\n        this.hp -= dmg;\r\n        const knock = (persistence.profile.upgrades.knock || 0) * 100;\r\n        if (bulletVx && bulletVy && knock > 0) {\r\n            const mag = Math.sqrt(bulletVx ** 2 + bulletVy ** 2);\r\n            if (mag > 0) {\r\n                this.vx += (bulletVx / mag) * knock;\r\n                this.vy += (bulletVy / mag) * knock;\r\n            }\r\n        }\r\n\r\n        if (this.hp <= 0) {\r\n            this.break(callbacks, allAsteroids, combo);\r\n        } else {\r\n            for (let i = 0; i < 3; i++) callbacks.spawnParticle(this.x, this.y, '#fff');\r\n        }\r\n    }\r\n\r\n    public break(callbacks: GameCallbacks, allAsteroids: Asteroid[], combo: number) {\r\n        this.dead = true;\r\n        tutorialSystem.checkAsteroidDestroyed();\r\n\r\n        callbacks.onCombo(); // Increment combo\r\n        audioSystem.playExplosion(this.sizeStr, 1 + (combo * 0.1));\r\n\r\n        if ((persistence.profile.upgrades.blast || 0) > 0) {\r\n            const range = 100 + (persistence.profile.upgrades.blast * 20);\r\n            allAsteroids.forEach(a => {\r\n                if (a !== this && !a.dead && (a.x - this.x) ** 2 + (a.y - this.y) ** 2 < range ** 2) {\r\n                    a.hp--;\r\n                    if (a.hp <= 0) a.break(callbacks, allAsteroids, combo); // Chain reaction!\r\n                }\r\n            });\r\n            for (let i = 0; i < 8; i++) callbacks.spawnParticle(this.x, this.y, '#f60');\r\n        }\r\n\r\n        const baseShards = this.sizeStr === 'large' ? 3 : (this.sizeStr === 'medium' ? 2 : 1);\r\n        const comboBonus = Math.floor(combo / 5);\r\n        const totalShards = baseShards + comboBonus;\r\n        persistence.addShards(totalShards);\r\n\r\n        const textCol = comboBonus > 0 ? '#ffd700' : '#b0f';\r\n        const textStr = comboBonus > 0 ? `+${totalShards}` : `+${totalShards}`;\r\n        callbacks.spawnText(this.x, this.y, textStr, textCol);\r\n\r\n        let pts = 0;\r\n        if (this.sizeStr === 'large') {\r\n            callbacks.spawnAsteroid(this.x, this.y, 'medium');\r\n            callbacks.spawnAsteroid(this.x, this.y, 'medium');\r\n            pts = 20;\r\n        } else if (this.sizeStr === 'medium') {\r\n            callbacks.spawnAsteroid(this.x, this.y, 'small');\r\n            callbacks.spawnAsteroid(this.x, this.y, 'small');\r\n            pts = 50;\r\n        } else {\r\n            pts = 100;\r\n        }\r\n\r\n        const luck = (persistence.profile.upgrades.luck || 0) * 0.02;\r\n        if (Math.random() < 0.03 + luck) {\r\n            const types = ['SHIELD', 'NUKE', 'SPEED'];\r\n            callbacks.spawnPowerUp(new PowerUp(this.x, this.y, types[Math.floor(Math.random() * types.length)]));\r\n        }\r\n\r\n        const scoreMult = 1 + ((persistence.profile.upgrades.score || 0) * 0.1);\r\n        callbacks.onScore(Math.ceil(pts * combo * scoreMult));\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\Boss.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\Bullet.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\FloatingText.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\Particle.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\PowerUp.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\entities\\Ship.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\AssistPilot.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\AudioSystem.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[789,792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[789,792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export class AudioSystem {\r\n    private ctx: AudioContext | null = null;\r\n    private masterGain: GainNode | null = null;\r\n    private initialized: boolean = false;\r\n\r\n    private tracks: Record<string, HTMLAudioElement> = {\r\n        load: new Audio('/music/load.mp3'),\r\n        shop: new Audio('/music/shop.mp3'),\r\n        wave: new Audio('/music/wave.mp3'),\r\n        boss: new Audio('/music/boss.mp3')\r\n    };\r\n    private currentTrack: HTMLAudioElement | null = null;\r\n    public lastTrackName: string | null = null;\r\n\r\n    constructor() {\r\n        Object.values(this.tracks).forEach(t => {\r\n            t.loop = true;\r\n            t.volume = 0.4;\r\n        });\r\n    }\r\n\r\n    public init() {\r\n        if (this.initialized) return;\r\n\r\n        const AC = window.AudioContext || (window as any).webkitAudioContext;\r\n        if (!AC) {\r\n            console.warn('AudioContext not supported');\r\n            return;\r\n        }\r\n        this.ctx = new AC();\r\n        this.masterGain = this.ctx.createGain();\r\n        this.masterGain.gain.value = 0.3;\r\n        this.masterGain.connect(this.ctx.destination);\r\n\r\n        if (this.ctx.state === 'suspended') {\r\n            this.ctx.resume();\r\n        }\r\n\r\n        // Unlock audio context on first user interaction\r\n        const unlock = () => {\r\n            if (this.ctx?.state === 'suspended') this.ctx.resume();\r\n            if (this.currentTrack) this.currentTrack.play().catch(() => { });\r\n\r\n            document.removeEventListener('click', unlock);\r\n            document.removeEventListener('touchstart', unlock);\r\n            document.removeEventListener('mousemove', unlock);\r\n            document.removeEventListener('keydown', unlock);\r\n        };\r\n\r\n        document.addEventListener('click', unlock);\r\n        document.addEventListener('touchstart', unlock);\r\n        document.addEventListener('mousemove', unlock);\r\n        document.addEventListener('keydown', unlock);\r\n\r\n        this.initialized = true;\r\n    }\r\n\r\n    private playTone(freq: number, type: OscillatorType, dur: number, vol: number = 0.5) {\r\n        if (!this.ctx || !this.masterGain) return;\r\n        const osc = this.ctx.createOscillator();\r\n        const g = this.ctx.createGain();\r\n        osc.type = type;\r\n        osc.frequency.setValueAtTime(freq, this.ctx.currentTime);\r\n        g.gain.setValueAtTime(vol, this.ctx.currentTime);\r\n        g.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + dur);\r\n        osc.connect(g);\r\n        g.connect(this.masterGain);\r\n        osc.start();\r\n        osc.stop(this.ctx.currentTime + dur);\r\n    }\r\n\r\n    // SFX Methods\r\n    public playShoot(pitchMod: number = 1) { this.playTone(880 * pitchMod, 'square', 0.1, 0.3); }\r\n    public playExplosion(sz: string, pitchMod: number = 1) { this.playTone(100 * pitchMod, 'sawtooth', sz === 'large' ? 0.4 : 0.2, 0.4); }\r\n    public playPowerUp() {\r\n        if (!this.ctx) return;\r\n        this.playTone(440, 'sine', 0.1);\r\n        setTimeout(() => this.playTone(880, 'sine', 0.2), 100);\r\n    }\r\n    public playShard() { this.playTone(1200, 'sine', 0.1, 0.1); }\r\n    public playHeavy(pitchMod: number = 1) { this.playTone(150 * pitchMod, 'square', 0.3, 0.5); }\r\n    public playDash() { this.playTone(600, 'sine', 0.2, 0.5); }\r\n    public playNuke() { this.playTone(100, 'sawtooth', 1.0, 0.8); }\r\n    public playAlarm() { this.playTone(400, 'sawtooth', 1.5, 0.4); }\r\n    public playComboUp(val: number) {\r\n        if (!this.ctx || !this.masterGain) return;\r\n        const osc = this.ctx.createOscillator();\r\n        const gain = this.ctx.createGain();\r\n        osc.type = 'square';\r\n        osc.frequency.setValueAtTime(400 + ((val || 1) * 100), this.ctx.currentTime);\r\n        gain.gain.setValueAtTime(0.1, this.ctx.currentTime);\r\n        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.1);\r\n        osc.connect(gain);\r\n        gain.connect(this.masterGain);\r\n        osc.start();\r\n        osc.stop(this.ctx.currentTime + 0.1);\r\n    }\r\n\r\n    // Music Methods\r\n    public playMusic(name: string) {\r\n        const track = this.tracks[name];\r\n        if (!track) return;\r\n\r\n        if (this.currentTrack === track) {\r\n            if (track.paused) track.play().catch(() => { });\r\n            return;\r\n        }\r\n\r\n        if (this.currentTrack) {\r\n            this.currentTrack.pause();\r\n            this.currentTrack.currentTime = 0;\r\n        }\r\n\r\n        this.currentTrack = track;\r\n        this.lastTrackName = name;\r\n        track.play().catch(e => console.warn(\"Music autoplay prevented:\", e));\r\n    }\r\n\r\n    public pauseMusic() {\r\n        if (this.currentTrack) this.currentTrack.pause();\r\n    }\r\n\r\n    public resumeMusic() {\r\n        if (this.currentTrack) this.currentTrack.play().catch(() => { });\r\n    }\r\n}\r\n\r\nexport const audioSystem = new AudioSystem();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\InputSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\Persistence.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\PhysicsSystem.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_e' is defined but never used.","line":92,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { SpatialGrid } from '../core/SpatialGrid';\r\n\r\n// Types for our entities (simplified for Physics)\r\ninterface PhysicsEntity {\r\n    x: number;\r\n    y: number;\r\n    radius: number;\r\n    active: boolean;\r\n    id?: number | string;\r\n}\r\n\r\nexport class PhysicsSystem {\r\n    private spatialGrid: SpatialGrid<PhysicsEntity>;\r\n    private _useGPU: boolean = false;\r\n    private device: GPUDevice | null = null;\r\n    private _pipeline: GPUComputePipeline | null = null;\r\n\r\n    constructor(width: number, height: number, cellSize: number) {\r\n        this.spatialGrid = new SpatialGrid(width, height, cellSize);\r\n        this.initGPU();\r\n    }\r\n\r\n    private async initGPU() {\r\n        if (!navigator.gpu) return;\r\n        try {\r\n            const adapter = await navigator.gpu.requestAdapter();\r\n            if (!adapter) return;\r\n            this.device = await adapter.requestDevice();\r\n\r\n            const shaderCode = `\r\n                struct Entity {\r\n                    position: vec2f,\r\n                    velocity: vec2f,\r\n                    radius: f32,\r\n                    active: u32,\r\n                }\r\n\r\n                struct CollisionResult {\r\n                    collided: u32,\r\n                    targetIndex: u32,\r\n                }\r\n\r\n                @group(0) @binding(0) var<storage, read> entitiesA: array<Entity>;\r\n                @group(0) @binding(1) var<storage, read> entitiesB: array<Entity>;\r\n                @group(0) @binding(2) var<storage, read_write> results: array<CollisionResult>;\r\n\r\n                @compute @workgroup_size(64)\r\n                fn main(@builtin(global_invocation_id) global_id: vec3u) {\r\n                    let indexA = global_id.x;\r\n                    if (indexA >= arrayLength(&entitiesA)) {\r\n                        return;\r\n                    }\r\n\r\n                    let entityA = entitiesA[indexA];\r\n                    if (entityA.active == 0u) {\r\n                        return;\r\n                    }\r\n                    \r\n                    for (var i = 0u; i < arrayLength(&entitiesB); i++) {\r\n                        let entityB = entitiesB[i];\r\n                        if (entityB.active == 0u) {\r\n                            continue;\r\n                        }\r\n\r\n                        let dx = entityA.position.x - entityB.position.x;\r\n                        let dy = entityA.position.y - entityB.position.y;\r\n                        let distSq = dx * dx + dy * dy;\r\n                        let radiusSum = entityA.radius + entityB.radius;\r\n\r\n                        if (distSq < radiusSum * radiusSum) {\r\n                            results[indexA].collided = 1u;\r\n                            results[indexA].targetIndex = i;\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            `;\r\n\r\n            const shaderModule = this.device.createShaderModule({\r\n                code: shaderCode\r\n            });\r\n\r\n            this._pipeline = this.device.createComputePipeline({\r\n                layout: 'auto',\r\n                compute: {\r\n                    module: shaderModule,\r\n                    entryPoint: 'main'\r\n                }\r\n            });\r\n\r\n            this._useGPU = true;\r\n        } catch (_e) {\r\n            // GPU init failed - using CPU fallback\r\n        }\r\n    }\r\n\r\n    public clearGrid() {\r\n        this.spatialGrid.clear();\r\n    }\r\n\r\n    public insertToGrid(obj: PhysicsEntity) {\r\n        this.spatialGrid.insert(obj);\r\n    }\r\n\r\n    public queryGrid(obj: PhysicsEntity, callback: (item: PhysicsEntity) => void): void {\r\n        this.spatialGrid.query(obj.x, obj.y, obj.radius, callback);\r\n    }\r\n\r\n    // CPU Fallback (Current Logic)\r\n    public checkCollisionsCPU(\r\n        groupA: PhysicsEntity[],\r\n        _groupB: PhysicsEntity[],\r\n        callback: (a: PhysicsEntity, b: PhysicsEntity) => void\r\n    ) {\r\n        // groupB is assumed to already be in the grid\r\n        for (const a of groupA) {\r\n            if (!a.active) continue;\r\n            this.queryGrid(a, (b) => {\r\n                if (!b.active) return;\r\n                const dx = a.x - b.x;\r\n                const dy = a.y - b.y;\r\n                const distSq = dx * dx + dy * dy;\r\n                const rSum = a.radius + b.radius;\r\n                if (distSq < rSum * rSum) {\r\n                    callback(a, b);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // GPU Implementation (Async) - Placeholder for future implementation\r\n    public async checkCollisionsGPU(\r\n        groupA: PhysicsEntity[],\r\n        groupB: PhysicsEntity[]\r\n    ): Promise<Array<{ aIndex: number; bIndex: number }>> {\r\n        if (!this._useGPU || !this.device || !this._pipeline) return [];\r\n\r\n        // Acknowledge parameters for future implementation\r\n        void groupA;\r\n        void groupB;\r\n\r\n        // Due to async nature, return empty for now\r\n        return [];\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\SpriteCache.ts","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":122,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":122,"endColumn":44,"suggestions":[{"messageId":"addBrackets","fix":{"range":[6113,6700],"text":"{ const arm = size * 0.3;\r\n                    ctx.moveTo(-arm, -size);\r\n                    ctx.lineTo(arm, -size);\r\n                    ctx.lineTo(arm, -arm);\r\n                    ctx.lineTo(size, -arm);\r\n                    ctx.lineTo(size, arm);\r\n                    ctx.lineTo(arm, arm);\r\n                    ctx.lineTo(arm, size);\r\n                    ctx.lineTo(-arm, size);\r\n                    ctx.lineTo(-arm, arm);\r\n                    ctx.lineTo(-size, arm);\r\n                    ctx.lineTo(-size, -arm);\r\n                    ctx.lineTo(-arm, -arm);\r\n                    break; }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export class SpriteCache {\r\n    private cache: Record<string, HTMLCanvasElement> = {};\r\n    private asteroids: Record<string, Record<string, HTMLCanvasElement[]>> = {};\r\n    private bullets: Record<string, HTMLCanvasElement> = {};\r\n\r\n    public init() {\r\n        const levelColors = ['#f0f', '#0f0', '#fa0', '#0ff', '#f00'];\r\n        levelColors.forEach(color => {\r\n            this.asteroids[color] = { large: [], medium: [], small: [] };\r\n            ['large', 'medium', 'small'].forEach(size => {\r\n                for (let i = 0; i < 5; i++) {\r\n                    const cvs = document.createElement('canvas');\r\n                    const r = size === 'large' ? 50 : (size === 'medium' ? 25 : 12);\r\n                    cvs.width = r * 2 + 10; cvs.height = r * 2 + 10;\r\n                    const ctx = cvs.getContext('2d')!;\r\n                    ctx.translate(r + 5, r + 5);\r\n                    ctx.strokeStyle = color; ctx.lineWidth = 2; ctx.fillStyle = 'rgba(0,0,0,0.5)';\r\n                    ctx.shadowColor = color; ctx.shadowBlur = 10;\r\n                    ctx.beginPath(); const c = 8;\r\n                    for (let j = 0; j < c; j++) {\r\n                        const a = (j / c) * Math.PI * 2;\r\n                        const rad = r * (0.8 + Math.random() * 0.4);\r\n                        if (j === 0) ctx.moveTo(Math.cos(a) * rad, Math.sin(a) * rad);\r\n                        else ctx.lineTo(Math.cos(a) * rad, Math.sin(a) * rad);\r\n                    }\r\n                    ctx.closePath(); ctx.fill(); ctx.stroke();\r\n                    this.asteroids[color][size].push(cvs);\r\n                }\r\n            });\r\n        });\r\n\r\n        // Pre-render bullets\r\n        ['BLASTER', 'SPREAD', 'RAPID', 'HEAVY', 'BOSS'].forEach(type => {\r\n            const cvs = document.createElement('canvas');\r\n            const size = type === 'HEAVY' ? 5 : (type === 'BOSS' ? 4 : 2);\r\n            let color = type === 'BLASTER' ? '#ff0' : (type === 'SPREAD' ? '#0f0' : (type === 'RAPID' ? '#f0f' : '#f00'));\r\n            if (type === 'BOSS') color = '#f30';\r\n            const shadow = type === 'BOSS' ? '#f00' : color;\r\n            const pad = 10;\r\n            cvs.width = size * 2 + pad * 2; cvs.height = size * 2 + pad * 2;\r\n            const ctx = cvs.getContext('2d')!;\r\n            ctx.translate(size + pad, size + pad);\r\n            ctx.shadowBlur = type === 'BOSS' ? 8 : 5; ctx.shadowColor = shadow;\r\n            ctx.fillStyle = color;\r\n            ctx.beginPath(); ctx.arc(0, 0, size, 0, Math.PI * 2); ctx.fill();\r\n            this.bullets[type] = cvs;\r\n        });\r\n    }\r\n\r\n    public getShip(color: string, design: string = 'fighter'): HTMLCanvasElement {\r\n        const key = `ship_${color}_${design}`;\r\n        if (!this.cache[key]) {\r\n            const cvs = document.createElement('canvas'); cvs.width = 40; cvs.height = 40; const ctx = cvs.getContext('2d')!;\r\n            ctx.translate(20, 20); ctx.rotate(-Math.PI / 2);\r\n            ctx.strokeStyle = color; ctx.fillStyle = 'rgba(0, 20, 20, 0.8)'; ctx.lineWidth = 3;\r\n            ctx.shadowColor = color; ctx.shadowBlur = 10;\r\n\r\n            ctx.beginPath();\r\n            if (design === 'interceptor') {\r\n                ctx.moveTo(20, 0); ctx.lineTo(-10, 15); ctx.lineTo(-5, 5); ctx.lineTo(-15, 5); ctx.lineTo(-15, -5); ctx.lineTo(-5, -5); ctx.lineTo(-10, -15);\r\n            } else if (design === 'tank') {\r\n                ctx.moveTo(15, 0); ctx.lineTo(5, 15); ctx.lineTo(-15, 10); ctx.lineTo(-10, 0); ctx.lineTo(-15, -10); ctx.lineTo(5, -15);\r\n            } else if (design === 'stealth') {\r\n                ctx.moveTo(20, 0); ctx.lineTo(-5, 10); ctx.lineTo(-20, 15); ctx.lineTo(-10, 0); ctx.lineTo(-20, -15); ctx.lineTo(-5, -10);\r\n            } else {\r\n                ctx.moveTo(20, 0); ctx.lineTo(-15, 15); ctx.lineTo(-5, 0); ctx.lineTo(-15, -15);\r\n            }\r\n            ctx.closePath(); ctx.stroke(); ctx.fill();\r\n\r\n            ctx.fillStyle = '#fff'; ctx.beginPath();\r\n            if (design === 'tank') { ctx.rect(-5, -3, 10, 6); }\r\n            else if (design === 'stealth') { ctx.moveTo(5, 0); ctx.lineTo(-5, 3); ctx.lineTo(-5, -3); }\r\n            else { ctx.moveTo(5, 0); ctx.lineTo(-8, 6); ctx.lineTo(-4, 0); ctx.lineTo(-8, -6); }\r\n            ctx.closePath(); ctx.fill();\r\n\r\n            this.cache[key] = cvs;\r\n        }\r\n        return this.cache[key];\r\n    }\r\n\r\n    public getBoss(): HTMLCanvasElement {\r\n        // Legacy method - returns default hexagon boss\r\n        return this.getBossSprite('hexagon', '#f00', 55);\r\n    }\r\n\r\n    public getBossSprite(type: string, color: string, size: number): HTMLCanvasElement {\r\n        const key = `boss_${type}_${color}_${size}`;\r\n        if (!this.cache[key]) {\r\n            const padding = 20;\r\n            const cvs = document.createElement('canvas');\r\n            cvs.width = size * 2 + padding * 2;\r\n            cvs.height = size * 2 + padding * 2;\r\n            const ctx = cvs.getContext('2d')!;\r\n            ctx.translate(size + padding, size + padding);\r\n            ctx.strokeStyle = color;\r\n            ctx.lineWidth = 4;\r\n            ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';\r\n            ctx.shadowColor = color;\r\n            ctx.shadowBlur = 15;\r\n\r\n            ctx.beginPath();\r\n            switch (type) {\r\n                case 'hexagon':\r\n                    for (let i = 0; i < 6; i++) {\r\n                        const a = i * (Math.PI * 2 / 6);\r\n                        if (i === 0) ctx.moveTo(Math.cos(a) * size, Math.sin(a) * size);\r\n                        else ctx.lineTo(Math.cos(a) * size, Math.sin(a) * size);\r\n                    }\r\n                    break;\r\n                case 'diamond':\r\n                    ctx.moveTo(0, -size);\r\n                    ctx.lineTo(size, 0);\r\n                    ctx.lineTo(0, size);\r\n                    ctx.lineTo(-size, 0);\r\n                    break;\r\n                case 'triangle':\r\n                    ctx.moveTo(0, -size);\r\n                    ctx.lineTo(size * 0.87, size * 0.5);\r\n                    ctx.lineTo(-size * 0.87, size * 0.5);\r\n                    break;\r\n                case 'cross':\r\n                    const arm = size * 0.3;\r\n                    ctx.moveTo(-arm, -size);\r\n                    ctx.lineTo(arm, -size);\r\n                    ctx.lineTo(arm, -arm);\r\n                    ctx.lineTo(size, -arm);\r\n                    ctx.lineTo(size, arm);\r\n                    ctx.lineTo(arm, arm);\r\n                    ctx.lineTo(arm, size);\r\n                    ctx.lineTo(-arm, size);\r\n                    ctx.lineTo(-arm, arm);\r\n                    ctx.lineTo(-size, arm);\r\n                    ctx.lineTo(-size, -arm);\r\n                    ctx.lineTo(-arm, -arm);\r\n                    break;\r\n                case 'star':\r\n                    for (let i = 0; i < 10; i++) {\r\n                        const a = (i * Math.PI * 2 / 10) - Math.PI / 2;\r\n                        const r = i % 2 === 0 ? size : size * 0.5;\r\n                        if (i === 0) ctx.moveTo(Math.cos(a) * r, Math.sin(a) * r);\r\n                        else ctx.lineTo(Math.cos(a) * r, Math.sin(a) * r);\r\n                    }\r\n                    break;\r\n                case 'ring':\r\n                    // Outer ring\r\n                    ctx.arc(0, 0, size, 0, Math.PI * 2);\r\n                    ctx.closePath();\r\n                    ctx.fill();\r\n                    ctx.stroke();\r\n                    // Inner ring\r\n                    ctx.beginPath();\r\n                    ctx.arc(0, 0, size * 0.6, 0, Math.PI * 2);\r\n                    break;\r\n                case 'mothership':\r\n                    // Large octagon with inner details\r\n                    for (let i = 0; i < 8; i++) {\r\n                        const a = i * (Math.PI * 2 / 8);\r\n                        if (i === 0) ctx.moveTo(Math.cos(a) * size, Math.sin(a) * size);\r\n                        else ctx.lineTo(Math.cos(a) * size, Math.sin(a) * size);\r\n                    }\r\n                    ctx.closePath();\r\n                    ctx.fill();\r\n                    ctx.stroke();\r\n                    // Inner core\r\n                    ctx.beginPath();\r\n                    ctx.arc(0, 0, size * 0.4, 0, Math.PI * 2);\r\n                    ctx.strokeStyle = '#ff0';\r\n                    ctx.stroke();\r\n                    // Spokes\r\n                    ctx.strokeStyle = color;\r\n                    for (let i = 0; i < 8; i++) {\r\n                        const a = i * (Math.PI * 2 / 8);\r\n                        ctx.beginPath();\r\n                        ctx.moveTo(Math.cos(a) * size * 0.4, Math.sin(a) * size * 0.4);\r\n                        ctx.lineTo(Math.cos(a) * size * 0.85, Math.sin(a) * size * 0.85);\r\n                        ctx.stroke();\r\n                    }\r\n                    this.cache[key] = cvs;\r\n                    return this.cache[key];\r\n                default:\r\n                    // Fallback to hexagon\r\n                    for (let i = 0; i < 6; i++) {\r\n                        const a = i * (Math.PI * 2 / 6);\r\n                        if (i === 0) ctx.moveTo(Math.cos(a) * size, Math.sin(a) * size);\r\n                        else ctx.lineTo(Math.cos(a) * size, Math.sin(a) * size);\r\n                    }\r\n            }\r\n            ctx.closePath();\r\n            ctx.fill();\r\n            ctx.stroke();\r\n            this.cache[key] = cvs;\r\n        }\r\n        return this.cache[key];\r\n    }\r\n\r\n    public getDreadnought(): HTMLCanvasElement {\r\n        if (!this.cache['dreadnought']) {\r\n            const cvs = document.createElement('canvas'); cvs.width = 200; cvs.height = 200; const ctx = cvs.getContext('2d')!;\r\n            ctx.translate(100, 100); ctx.strokeStyle = '#f30'; ctx.lineWidth = 6; ctx.fillStyle = '#100'; ctx.beginPath(); for (let i = 0; i < 8; i++) { const a = i * (Math.PI * 2 / 8); ctx.lineTo(Math.cos(a) * 90, Math.sin(a) * 90); } ctx.closePath(); ctx.fill(); ctx.stroke();\r\n            ctx.strokeStyle = '#f80'; ctx.lineWidth = 3; ctx.beginPath(); ctx.arc(0, 0, 40, 0, Math.PI * 2); ctx.stroke();\r\n            this.cache['dreadnought'] = cvs;\r\n        }\r\n        return this.cache['dreadnought'];\r\n    }\r\n\r\n    public getAsteroid(size: string, color: string): HTMLCanvasElement {\r\n        const colGroup = this.asteroids[color];\r\n        if (!colGroup) return this.asteroids['#f0f'][size][0];\r\n        const arr = colGroup[size];\r\n        return arr[Math.floor(Math.random() * arr.length)];\r\n    }\r\n\r\n    public getBullet(type: string): HTMLCanvasElement {\r\n        return this.bullets[type] || this.bullets['BLASTER'];\r\n    }\r\n    public getPowerUp(type: string): HTMLCanvasElement {\r\n        if (!this.cache[`pu_${type}`]) {\r\n            const cvs = document.createElement('canvas'); cvs.width = 30; cvs.height = 30; const ctx = cvs.getContext('2d')!;\r\n            ctx.translate(15, 15);\r\n            if (type === 'SHIELD') {\r\n                ctx.fillStyle = '#0ff'; ctx.strokeStyle = '#fff'; ctx.beginPath(); ctx.arc(0, 0, 10, 0, Math.PI * 2); ctx.fill(); ctx.stroke();\r\n                ctx.fillStyle = '#000'; ctx.font = 'bold 12px Arial'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillText('S', 0, 1);\r\n            } else if (type === 'NUKE') {\r\n                ctx.fillStyle = '#f00'; ctx.strokeStyle = '#fff'; ctx.beginPath(); ctx.arc(0, 0, 10, 0, Math.PI * 2); ctx.fill(); ctx.stroke();\r\n                ctx.fillStyle = '#000'; ctx.font = 'bold 12px Arial'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillText('N', 0, 1);\r\n            } else if (type === 'SPEED') {\r\n                ctx.fillStyle = '#ff0'; ctx.strokeStyle = '#fff'; ctx.beginPath(); ctx.arc(0, 0, 10, 0, Math.PI * 2); ctx.fill(); ctx.stroke();\r\n                ctx.fillStyle = '#000'; ctx.font = 'bold 12px Arial'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillText('ΓÜí', 0, 1);\r\n            }\r\n            this.cache[`pu_${type}`] = cvs;\r\n        }\r\n        return this.cache[`pu_${type}`];\r\n    }\r\n\r\n    public getUFO(): HTMLCanvasElement {\r\n        if (!this.cache['ufo']) {\r\n            const cvs = document.createElement('canvas'); cvs.width = 40; cvs.height = 40; const ctx = cvs.getContext('2d')!;\r\n            ctx.translate(20, 20);\r\n            ctx.fillStyle = '#f60'; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2;\r\n            ctx.beginPath(); ctx.ellipse(0, 0, 15, 6, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();\r\n            ctx.beginPath(); ctx.arc(0, -3, 8, Math.PI, 0); ctx.fillStyle = 'rgba(0,255,255,0.5)'; ctx.fill(); ctx.stroke();\r\n            this.cache['ufo'] = cvs;\r\n        }\r\n        return this.cache['ufo'];\r\n    }\r\n}\r\n\r\nexport const spriteCache = new SpriteCache();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\systems\\TutorialSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\game\\utils\\IconDrawer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\views\\CanvasView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\src\\views\\ParticleSystemView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\tests\\e2e\\comprehensive.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\tests\\e2e\\verify_all_upgrades.spec.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[412,415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[412,415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[517,520],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[517,520],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[583,586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[583,586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[735,738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[735,738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[915,918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[915,918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1224,1227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1224,1227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1514,1517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1514,1517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1895,1898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1895,1898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2062,2065],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2062,2065],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2436,2439],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2436,2439],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2604,2607],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2604,2607],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2892,2895],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2892,2895],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3177,3180],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3177,3180],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3457,3460],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3457,3460],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3830,3833],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3830,3833],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3998,4001],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3998,4001],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":105,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4369,4372],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4369,4372],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4537,4540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4537,4540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":117,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4906,4909],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4906,4909],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5080,5083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5080,5083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":129,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5404,5407],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5404,5407],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":136,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5681,5684],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5681,5684],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5776,5779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5776,5779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":147,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6213,6216],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6213,6216],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6380,6383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6380,6383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":160,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6801,6804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6801,6804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6888,6891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6888,6891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":165,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7057,7060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7057,7060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":166,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7140,7143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7140,7143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":174,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7505,7508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7505,7508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":182,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7789,7792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7789,7792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":183,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7840,7843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7840,7843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":186,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7979,7982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7979,7982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":188,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":188,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8096,8099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8096,8099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8477,8480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8477,8480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":209,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8886,8889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8886,8889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":209,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8933,8936],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8933,8936],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":213,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9046,9049],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9046,9049],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":216,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9182,9185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9182,9185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":225,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9463,9466],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9463,9466],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":232,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9755,9758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9755,9758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":239,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":239,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10036,10039],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10036,10039],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":245,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10226,10229],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10226,10229],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":246,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10298,10301],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10298,10301],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":247,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":247,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10384,10387],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10384,10387],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":250,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10517,10520],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10517,10520],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":46,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { test, expect } from '@playwright/test';\r\n\r\ntest.describe('Comprehensive Shop Verification', () => {\r\n\r\n    test.beforeEach(async ({ page }) => {\r\n        await page.addInitScript(() => localStorage.clear());\r\n        await page.goto('/');\r\n        await expect(page.getByRole('button', { name: \"LET'S GO!\" })).toBeVisible();\r\n    });\r\n\r\n    // Helper to set upgrade\r\n    const setUpgrade = async (page: any, key: string, val: number) => {\r\n        await page.evaluate(({ k, v }) => {\r\n            (window as any).persistence.profile.upgrades[k] = v;\r\n            (window as any).persistence.save();\r\n        }, { k: key, v: val });\r\n    };\r\n\r\n    // Helper to start game and wait for ready\r\n    const startGame = async (page: any) => {\r\n        await page.getByRole('button', { name: \"LET'S GO!\" }).click();\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine?.gameState);\r\n        }).toBe('PLAYING');\r\n    };\r\n\r\n    // --- OFFENSE ---\r\n\r\n    test('Damage upgrade increases damage multiplier', async ({ page }) => {\r\n        await setUpgrade(page, 'damage', 5);\r\n        await startGame(page);\r\n        const mult = await page.evaluate(() => (window as any).gameEngine.ship.damageMult);\r\n        expect(mult).toBe(1.5);\r\n    });\r\n\r\n    test('Fire Rate upgrade reduces weapon delay', async ({ page }) => {\r\n        await setUpgrade(page, 'fireRate', 5);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.fireRate);\r\n        expect(val).toBe(5);\r\n    });\r\n\r\n    test('Bullet Speed upgrade increases speed', async ({ page }) => {\r\n        await setUpgrade(page, 'bulletSpd', 3);\r\n        await startGame(page);\r\n        await page.keyboard.down('Space');\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        }).toBeGreaterThan(0);\r\n        await page.keyboard.up('Space');\r\n        const speed = await page.evaluate(() => (window as any).gameEngine.bullets[0]?.speed);\r\n        expect(speed).toBe(960);\r\n    });\r\n\r\n    test('Pierce upgrade increases pierce count', async ({ page }) => {\r\n        await setUpgrade(page, 'pierce', 2);\r\n        await startGame(page);\r\n        await page.keyboard.down('Space');\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        }).toBeGreaterThan(0);\r\n        await page.keyboard.up('Space');\r\n        const pierce = await page.evaluate(() => (window as any).gameEngine.bullets[0]?.pierce);\r\n        expect(pierce).toBe(3);\r\n    });\r\n\r\n    test('Blast upgrade enables chain reaction', async ({ page }) => {\r\n        await setUpgrade(page, 'blast', 3);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.blast);\r\n        expect(val).toBe(3);\r\n    });\r\n\r\n    test('Crit upgrade enables crit chance', async ({ page }) => {\r\n        await setUpgrade(page, 'crit', 3);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.crit);\r\n        expect(val).toBe(3);\r\n    });\r\n\r\n    test('Knockback upgrade is loaded', async ({ page }) => {\r\n        await setUpgrade(page, 'knock', 3);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.knock);\r\n        expect(val).toBe(3);\r\n    });\r\n\r\n    test('Size upgrade increases bullet radius', async ({ page }) => {\r\n        await setUpgrade(page, 'size', 3);\r\n        await startGame(page);\r\n        await page.keyboard.down('Space');\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        }).toBeGreaterThan(0);\r\n        await page.keyboard.up('Space');\r\n        const radius = await page.evaluate(() => (window as any).gameEngine.bullets[0]?.radius);\r\n        expect(radius).toBe(5);\r\n    });\r\n\r\n    test('Homing upgrade enables homing flag', async ({ page }) => {\r\n        await setUpgrade(page, 'homing', 1);\r\n        await startGame(page);\r\n        await page.keyboard.down('Space');\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        }).toBeGreaterThan(0);\r\n        await page.keyboard.up('Space');\r\n        const homing = await page.evaluate(() => (window as any).gameEngine.bullets[0]?.homing);\r\n        expect(homing).toBe(true);\r\n    });\r\n\r\n    test('Rear Shot fires backward bullet', async ({ page }) => {\r\n        await setUpgrade(page, 'rear', 1);\r\n        await startGame(page);\r\n        await page.keyboard.down('Space');\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        }).toBeGreaterThanOrEqual(2);\r\n        await page.keyboard.up('Space');\r\n        const count = await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        expect(count).toBeGreaterThanOrEqual(2);\r\n    });\r\n\r\n    // --- DEFENSE ---\r\n\r\n    test('Hull upgrade increases max lives', async ({ page }) => {\r\n        await setUpgrade(page, 'hull', 3);\r\n        await startGame(page);\r\n        const lives = await page.evaluate(() => (window as any).gameEngine.ship.maxLives);\r\n        expect(lives).toBe(6);\r\n    });\r\n\r\n    test('Shield Duration increases invincibility', async ({ page }) => {\r\n        await setUpgrade(page, 'shieldDur', 3);\r\n        await startGame(page);\r\n        await page.evaluate(() => (window as any).gameEngine.handlePlayerHit());\r\n        const time = await page.evaluate(() => (window as any).gameEngine.ship.invincibleTime);\r\n        expect(time).toBeGreaterThan(3.0);\r\n    });\r\n\r\n    test('Dash Cooldown reduces cooldown', async ({ page }) => {\r\n        await setUpgrade(page, 'dashCool', 3);\r\n        await startGame(page);\r\n        await page.keyboard.down('Shift');\r\n        // Wait for dash to activate (cooldown starts)\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.ship.dashCooldown);\r\n        }).toBeGreaterThan(0);\r\n        await page.keyboard.up('Shift');\r\n        const cd = await page.evaluate(() => (window as any).gameEngine.ship.dashCooldown);\r\n        expect(cd).toBeGreaterThan(1.0);\r\n    });\r\n\r\n    test('Dash Distance increases velocity', async ({ page }) => {\r\n        await setUpgrade(page, 'dashDist', 3);\r\n        await startGame(page);\r\n        await page.keyboard.press('Shift');\r\n        // Wait for velocity change\r\n        await expect.poll(async () => {\r\n            const vx = await page.evaluate(() => (window as any).gameEngine.ship.vx);\r\n            const vy = await page.evaluate(() => (window as any).gameEngine.ship.vy);\r\n            return Math.sqrt(vx * vx + vy * vy);\r\n        }).toBeGreaterThan(100);\r\n\r\n        const vx = await page.evaluate(() => (window as any).gameEngine.ship.vx);\r\n        const vy = await page.evaluate(() => (window as any).gameEngine.ship.vy);\r\n        const speed = Math.sqrt(vx * vx + vy * vy);\r\n        expect(speed).toBeCloseTo(1320, -1); // Loose equality for float math\r\n    });\r\n\r\n    test('Regen enables regen timer', async ({ page }) => {\r\n        await setUpgrade(page, 'regen', 1);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.regen);\r\n        expect(val).toBe(1);\r\n    });\r\n\r\n    test('Revive enables revive flag', async ({ page }) => {\r\n        await setUpgrade(page, 'revive', 1);\r\n        await startGame(page);\r\n        await page.evaluate(() => {\r\n            (window as any).gameEngine.lives = 0;\r\n            (window as any).gameEngine.gameOver();\r\n        });\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any).gameEngine.hasRevived);\r\n        }).toBe(true);\r\n        const gameState = await page.evaluate(() => (window as any).gameEngine.gameState);\r\n        expect(gameState).toBe('PLAYING');\r\n    });\r\n\r\n    test('Armor/Evasion/Thorns upgrades loaded', async ({ page }) => {\r\n        await setUpgrade(page, 'armor', 3);\r\n        await setUpgrade(page, 'evasion', 3);\r\n        await setUpgrade(page, 'thorns', 3);\r\n        await startGame(page);\r\n        const u = await page.evaluate(() => (window as any).persistence.profile.upgrades);\r\n        expect(u.armor).toBe(3);\r\n        expect(u.evasion).toBe(3);\r\n        expect(u.thorns).toBe(3);\r\n    });\r\n\r\n    test('Nova upgrade triggers explosion on hit', async ({ page }) => {\r\n        await setUpgrade(page, 'nova', 1);\r\n        await startGame(page);\r\n\r\n        // Mock audioSystem to track calls\r\n        await page.evaluate(() => {\r\n            (window as any).audioSystem.playNuke = () => { (window as any)._nukeCalled = true; };\r\n        });\r\n\r\n        // Trigger hit\r\n        await page.evaluate(() => (window as any).gameEngine.handlePlayerHit());\r\n\r\n        await expect.poll(async () => {\r\n            return await page.evaluate(() => (window as any)._nukeCalled);\r\n        }).toBe(true);\r\n    });\r\n\r\n    // --- UTILITY ---\r\n\r\n    test('Speed upgrade increases thrust', async ({ page }) => {\r\n        await setUpgrade(page, 'speed', 5);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.speed);\r\n        expect(val).toBe(5);\r\n    });\r\n\r\n    test('Magnet upgrade increases pickup range', async ({ page }) => {\r\n        await setUpgrade(page, 'magnet', 3);\r\n        await startGame(page);\r\n        const val = await page.evaluate(() => (window as any).persistence.profile.upgrades.magnet);\r\n        expect(val).toBe(3);\r\n    });\r\n\r\n    test('Start upgrade skips waves', async ({ page }) => {\r\n        await setUpgrade(page, 'start', 1);\r\n        await startGame(page);\r\n        const wave = await page.evaluate(() => (window as any).gameEngine.wave);\r\n        expect(wave).toBe(4);\r\n    });\r\n\r\n    test('Skins update ship appearance', async ({ page }) => {\r\n        await page.evaluate(() => {\r\n            (window as any).persistence.profile.equippedSkin = 'ruby';\r\n            (window as any).persistence.profile.unlockedSkins = ['default', 'ruby'];\r\n            (window as any).persistence.save();\r\n        });\r\n        await startGame(page);\r\n        const skinName = await page.evaluate(() => (window as any).gameEngine.ship.skin.name);\r\n        expect(skinName).toBe('Ruby Ace');\r\n    });\r\n\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\tests\\e2e\\verify_icons.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\tests\\e2e\\verify_issues.spec.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[888,891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[888,891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[918,921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[918,921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'levelTitle' is assigned a value but never used.","line":108,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":108,"endColumn":25},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":113,"column":13,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":113,"endColumn":26,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[4772,4785],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":115,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":115,"endColumn":30,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[4877,4890],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { test, expect } from '@playwright/test';\r\n\r\ntest.describe('Game Issues - Paranoid Mode', () => {\r\n    test.beforeEach(async ({ page }) => {\r\n        page.on('pageerror', exception => {\r\n            console.log(`PAGE ERROR: ${exception}`);\r\n        });\r\n        page.on('console', msg => console.log(`BROWSER LOG: ${msg.text()}`));\r\n\r\n        // Clear state to ensure fresh start for each test\r\n        await page.addInitScript(() => {\r\n            window.localStorage.clear();\r\n        });\r\n\r\n        await page.goto('/');\r\n\r\n        // Rule 1: Hydration Wait - wait for start screen (actual rendered content)\r\n        const startScreen = page.locator('#start-screen');\r\n        await expect(startScreen).toBeVisible({ timeout: 10000 });\r\n\r\n        // Wait for game engine to be attached to window AND initialized (canvas set)\r\n        await page.waitForFunction(() => (window as any).gameEngine && (window as any).gameEngine.canvas);\r\n    });\r\n\r\n    test('Pause Screen should lead to Shop', async ({ page }) => {\r\n        // Rule 3: Actionability - assert visible before clicking\r\n        const startButton = page.getByRole('button', { name: /let's go|begin journey/i });\r\n        await expect(startButton).toBeVisible();\r\n        await startButton.click();\r\n\r\n        // Wait for start screen to hide\r\n        await expect(page.locator('#start-screen')).toBeHidden();\r\n\r\n        // Rule 4: Wait for game to be ready - check for canvas\r\n        const canvas = page.locator('#gameCanvas');\r\n        await expect(canvas).toBeVisible();\r\n\r\n        // Wait for pause button to appear (indicates game loop started)\r\n        // Wait for pause button to appear (indicates game loop started)\r\n        // Handle both desktop and mobile pause buttons by selecting the visible one\r\n        const pauseBtn = page.locator('#pause-btn-hud:visible, #mobile-pause-btn:visible').first();\r\n        await expect(pauseBtn).toBeVisible();\r\n        await pauseBtn.click();\r\n\r\n        // Wait for pause screen\r\n        const pauseScreen = page.locator('#pause-screen');\r\n        await expect(pauseScreen).toBeVisible();\r\n\r\n        // Click Shop button\r\n        const shopBtn = page.locator('#pause-shop-btn');\r\n        await expect(shopBtn).toBeVisible();\r\n        await shopBtn.click();\r\n\r\n        // Verify shop screen appears\r\n        const shopScreen = page.locator('#shop-screen');\r\n        await expect(shopScreen).toBeVisible();\r\n\r\n        // Close Shop - Should return to Pause Screen\r\n        const closeBtn = page.getByRole('button', { name: /all set/i });\r\n        await expect(closeBtn).toBeVisible();\r\n        await closeBtn.click();\r\n\r\n        // Verify shop closed and pause screen visible\r\n        await expect(shopScreen).toBeHidden();\r\n        await expect(pauseScreen).toBeVisible();\r\n    });\r\n\r\n    test('Tutorial should be present', async ({ page }) => {\r\n        // Start Game\r\n        const startButton = page.getByRole('button', { name: /let's go|begin journey/i });\r\n        await expect(startButton).toBeVisible();\r\n        await startButton.click();\r\n\r\n        await expect(page.locator('#start-screen')).toBeHidden();\r\n\r\n        // Wait for canvas to be ready\r\n        await expect(page.locator('#gameCanvas')).toBeVisible();\r\n\r\n        // Check for Tutorial Layer\r\n        const tutorialLayer = page.locator('#tutorial-layer');\r\n        await expect(tutorialLayer).toBeVisible({ timeout: 10000 });\r\n    });\r\n\r\n    test('Wave 1 should appear only after tutorial', async ({ page }) => {\r\n        // Start Game\r\n        const startButton = page.getByRole('button', { name: /let's go|begin journey/i });\r\n        await expect(startButton).toBeVisible();\r\n        await startButton.click();\r\n\r\n        await expect(page.locator('#start-screen')).toBeHidden();\r\n\r\n        // Wait for game to be ready\r\n        await expect(page.locator('#gameCanvas')).toBeVisible();\r\n\r\n        // 1. Verify Tutorial Active & Wave 1 Hidden\r\n        const tutorialLayer = page.locator('#tutorial-layer');\r\n        await expect(tutorialLayer).toBeVisible({ timeout: 10000 });\r\n\r\n        // Check Wave text is hidden during tutorial\r\n        const waveText = page.locator('.hud-center .hud-stat', { hasText: 'WAVE' });\r\n        await expect(waveText).toBeHidden();\r\n\r\n        // Check Level Overlay is not showing\r\n        const levelScreen = page.locator('#level-screen');\r\n        await expect(levelScreen).toBeAttached();\r\n        await expect(levelScreen).not.toHaveClass(/show-level/);\r\n\r\n        const levelTitle = page.locator('#level-title');\r\n        // await expect(levelTitle).toBeHidden(); // Flaky due to CSS transitions, relying on parent class check\r\n\r\n        // 2. Complete Tutorial programmatically\r\n        const success = await page.evaluate(() => {\r\n            // @ts-ignore\r\n            if (window.gameEngine && window.gameEngine.tutorialSystem) {\r\n                // @ts-ignore\r\n                window.gameEngine.tutorialSystem.end();\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        expect(success).toBe(true);\r\n\r\n        // 3. Verify Tutorial Hidden & Wave 1 Visible\r\n        await expect(tutorialLayer).toBeHidden();\r\n\r\n        // Wait for Wave text to appear - increased timeout for stability\r\n        await expect(waveText).toBeVisible({ timeout: 10000 });\r\n\r\n        const levelVal = page.locator('#level-val');\r\n        await expect(levelVal).toHaveText('1');\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\tests\\e2e\\verify_shop_upgrades.spec.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[763,766],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[763,766],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[979,982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[979,982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2040,2043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2040,2043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2996,2999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2996,2999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4016,4019],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4016,4019],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5492,5495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5492,5495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { test, expect } from '@playwright/test';\r\n\r\ntest.describe('Shop Power-up Verification', () => {\r\n\r\n    test.beforeEach(async ({ page }) => {\r\n        // Clear storage before each test\r\n        await page.addInitScript(() => {\r\n            localStorage.clear();\r\n        });\r\n    });\r\n\r\n    test('Base stats should be correct without upgrades', async ({ page }) => {\r\n        await page.goto('/');\r\n        await expect(page.locator('body')).toBeVisible();\r\n\r\n        // Start game\r\n        const startBtn = page.getByRole('button', { name: \"LET'S GO!\" });\r\n        await expect(startBtn).toBeVisible();\r\n        await startBtn.click();\r\n\r\n        // Check base stats\r\n        const stats = await page.evaluate(() => {\r\n            const ship = (window as any).gameEngine.ship;\r\n            return {\r\n                maxLives: ship.maxLives,\r\n                damageMult: ship.damageMult,\r\n                dashCooldown: ship.dashCooldown,\r\n                wave: (window as any).gameEngine.wave\r\n            };\r\n        });\r\n\r\n        expect(stats.maxLives).toBe(3);\r\n        expect(stats.damageMult).toBe(1);\r\n        expect(stats.wave).toBe(1);\r\n    });\r\n\r\n    test('Hull upgrade should increase max lives', async ({ page }) => {\r\n        // Inject Hull Upgrade Level 5\r\n        await page.addInitScript(() => {\r\n            const profile = {\r\n                shards: 0,\r\n                highScore: 0,\r\n                equippedSkin: 'default',\r\n                unlockedSkins: ['default'],\r\n                upgrades: { hull: 5 }, // +5 lives\r\n                maxWave: 0,\r\n                tutorialComplete: false\r\n            };\r\n            localStorage.setItem('hyperShardsProfile', JSON.stringify(profile));\r\n        });\r\n\r\n        await page.goto('/');\r\n        await expect(page.locator('body')).toBeVisible();\r\n\r\n        const startBtn = page.getByRole('button', { name: \"LET'S GO!\" });\r\n        await expect(startBtn).toBeVisible();\r\n        await startBtn.click();\r\n\r\n        const lives = await page.evaluate(() => (window as any).gameEngine.ship.maxLives);\r\n        expect(lives).toBe(8); // 3 base + 5 upgrade\r\n    });\r\n\r\n    test('Start upgrade should skip waves', async ({ page }) => {\r\n        // Inject Start Upgrade Level 1\r\n        await page.addInitScript(() => {\r\n            const profile = {\r\n                shards: 0,\r\n                highScore: 0,\r\n                equippedSkin: 'default',\r\n                unlockedSkins: ['default'],\r\n                upgrades: { start: 1 },\r\n                maxWave: 0,\r\n                tutorialComplete: false\r\n            };\r\n            localStorage.setItem('hyperShardsProfile', JSON.stringify(profile));\r\n        });\r\n\r\n        await page.goto('/');\r\n        await expect(page.locator('body')).toBeVisible();\r\n\r\n        const startBtn = page.getByRole('button', { name: \"LET'S GO!\" });\r\n        await expect(startBtn).toBeVisible();\r\n        await startBtn.click();\r\n\r\n        const wave = await page.evaluate(() => (window as any).gameEngine.wave);\r\n        expect(wave).toBe(4);\r\n    });\r\n\r\n    test('Damage and Fire Rate upgrades should modify ship stats', async ({ page }) => {\r\n        // Inject Damage Lvl 5 (+50%) and FireRate Lvl 5 (-25% delay)\r\n        await page.addInitScript(() => {\r\n            const profile = {\r\n                shards: 0,\r\n                highScore: 0,\r\n                equippedSkin: 'default',\r\n                unlockedSkins: ['default'],\r\n                upgrades: { damage: 5, fireRate: 5 },\r\n                maxWave: 0,\r\n                tutorialComplete: false\r\n            };\r\n            localStorage.setItem('hyperShardsProfile', JSON.stringify(profile));\r\n        });\r\n\r\n        await page.goto('/');\r\n        await expect(page.locator('body')).toBeVisible();\r\n\r\n        const startBtn = page.getByRole('button', { name: \"LET'S GO!\" });\r\n        await expect(startBtn).toBeVisible();\r\n        await startBtn.click();\r\n\r\n        const stats = await page.evaluate(() => {\r\n            const ship = (window as any).gameEngine.ship;\r\n            return {\r\n                damageMult: ship.damageMult\r\n            };\r\n        });\r\n\r\n        expect(stats.damageMult).toBe(1.5); // 1 + (5 * 0.1)\r\n    });\r\n\r\n    test('Rear Shot upgrade should fire backward bullet', async ({ page }) => {\r\n        // Inject Rear Upgrade\r\n        await page.addInitScript(() => {\r\n            const profile = {\r\n                shards: 0,\r\n                highScore: 0,\r\n                equippedSkin: 'default',\r\n                unlockedSkins: ['default'],\r\n                upgrades: { rear: 1 },\r\n                maxWave: 0,\r\n                tutorialComplete: false\r\n            };\r\n            localStorage.setItem('hyperShardsProfile', JSON.stringify(profile));\r\n        });\r\n\r\n        await page.goto('/');\r\n        await expect(page.locator('body')).toBeVisible();\r\n\r\n        const startBtn = page.getByRole('button', { name: \"LET'S GO!\" });\r\n        await expect(startBtn).toBeVisible();\r\n        await startBtn.click();\r\n\r\n        // Fire a shot (hold key to ensure game loop catches it)\r\n        await page.keyboard.down('Space');\r\n        await page.waitForTimeout(200); // Wait for a few frames\r\n        await page.keyboard.up('Space');\r\n\r\n        // Check bullet count. Should be at least 2 (one front, one rear)\r\n        // Note: might need a small wait for update loop to process input\r\n        await page.waitForTimeout(100);\r\n\r\n        const bulletCount = await page.evaluate(() => (window as any).gameEngine.bullets.length);\r\n        expect(bulletCount).toBeGreaterThanOrEqual(2);\r\n    });\r\n\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\njyti\\Desktop\\Google-Antigravity\\hyper-shards-v7\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
